
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>39. Case Study: Jokes &#8212; Data Science - A practical Approach</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.e8f53015daec13862f6db5e763c41738.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="38. Case Study: User survey" href="UserSurvey.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      
      <h1 class="site-logo" id="site-title">Data Science - A practical Approach</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../foreword.html">
   Foreword
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  1. Introduction
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../c1_introduction/introduction.html">
   1. Introduction
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  2. Data Preparation
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../c2_data_preparation/introduction.html">
   2. Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../c2_data_preparation/missing_data.html">
   3. Missing Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../c2_data_preparation/concatenation_deduplication.html">
   4. Concatenation and deduplication
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../c2_data_preparation/outliers.html">
   5. Outliers and validity
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../c2_data_preparation/string_operations.html">
   6. String operations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../c2_data_preparation/datetime_operations.html">
   7. Datetime operations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../c2_data_preparation/categorical_encoding.html">
   8. Categorical encoding
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../c2_data_preparation/scaling_normalization.html">
   10. Scaling and Normalization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../c2_data_preparation/binning_ranking.html">
   11. Binning and ranking
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../c2_data_preparation/some_practice.html">
   12. Some practice
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  3. Data Preprocessing
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../c3_data_preprocessing/introduction.html">
   13. Data Preprocessing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../c3_data_preprocessing/indexing_slicing.html">
   14. Indexing and slicing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../c3_data_preprocessing/merge.html">
   15. Merge
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../c3_data_preprocessing/groupby.html">
   16. Groupby
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../c3_data_preprocessing/pivot.html">
   17. Pivot
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../c3_data_preprocessing/sql_integration.html">
   18. Using SQL
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  4. Data Visualisation
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../c4_data_visualisation/introduction.html">
   19. Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../c4_data_visualisation/line.html">
   20. Line plot
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../c4_data_visualisation/histogram.html">
   21. Histogram plot
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../c4_data_visualisation/box.html">
   22. Box plot
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../c4_data_visualisation/scatter.html">
   23. Scatter plot
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../c4_data_visualisation/heatmap.html">
   24. Heatmap plot
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  5. Data Exploration
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../c5_data_exploration/introduction.html">
   25. Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../c5_data_exploration/variable_identification.html">
   26. Variable identification
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../c5_data_exploration/univariate_analysis.html">
   27. Uni-variate analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../c5_data_exploration/bivariate_analysis.html">
   28. Bi-variate analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../c5_data_exploration/external_data.html">
   29. New Data Sources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../c5_data_exploration/feature_engineering.html">
   30. Feature Enhancing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../c5_data_exploration/cluster_analysis.html">
   31. Cluster analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../c5_data_exploration/variance_inflation.html">
   32. VIF: Variance Inflation Factor
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../c5_data_exploration/principle_component_analysis.html">
   33. Principle Component Analysis
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  6. Machine Learning
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../c6_machine_learning/introduction.html">
   34. Machine Learning
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  7. Case Studies
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Olist.html">
   35. Case study: Olist
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Churn.html">
   36. Case Study: Churn
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Olympics.html">
   37. Case Study: Olympic medals
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="UserSurvey.html">
   38. Case Study: User survey
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   39. Case Study: Jokes
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/c7_case_studies/Jokes.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/LorenzF/data-science-practical-approach"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/LorenzF/data-science-practical-approach/issues/new?title=Issue%20on%20page%20%2Fc7_case_studies/Jokes.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/LorenzF/data-science-practical-approach/master?urlpath=tree/src/c7_case_studies/Jokes.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/LorenzF/data-science-practical-approach/blob/master/src/c7_case_studies/Jokes.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#goals">
   39.1. Goals
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#parsing">
   39.2. Parsing
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#preparation">
   39.3. Preparation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cleanup">
     39.3.1. Cleanup
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data-types">
     39.3.2. Data Types
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#missing-values">
     39.3.3. Missing values
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#duplicates">
     39.3.4. Duplicates
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#text-formatting">
     39.3.5. Text formatting
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#processing">
   39.4. Processing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#timing-of-joke">
     39.4.1. Timing of joke
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bag-of-words">
     39.4.2. Bag of words
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#term-frequency-inverse-document-frequency">
     39.4.3. Term Frequency - Inverse Document Frequency
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exploration">
   39.5. Exploration
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="case-study-jokes">
<h1><span class="section-number">39. </span>Case Study: Jokes<a class="headerlink" href="#case-study-jokes" title="Permalink to this headline">¶</a></h1>
<p>In this case study we find out if we can make ourselves funnier by analysing jokes from a database.</p>
<p>The case study is divided into several parts:</p>
<ul class="simple">
<li><p>Goals</p></li>
<li><p>Parsing</p></li>
<li><p>Preparation (cleaning)</p></li>
<li><p>Processing</p></li>
<li><p>Exploration</p></li>
<li><p>Visualization</p></li>
<li><p>Conclusion</p></li>
</ul>
<div class="section" id="goals">
<h2><span class="section-number">39.1. </span>Goals<a class="headerlink" href="#goals" title="Permalink to this headline">¶</a></h2>
<p>In this section we define questions that will be our guideline througout the case study</p>
<ul class="simple">
<li><p>What jokes are funny?</p></li>
<li><p>Can we find types of jokes?</p></li>
<li><p>Would a joke recommender work?</p></li>
</ul>
<p>We’ll (try to) keep these question in mind when performing the case study.</p>
</div>
<div class="section" id="parsing">
<h2><span class="section-number">39.2. </span>Parsing<a class="headerlink" href="#parsing" title="Permalink to this headline">¶</a></h2>
<p>we start out by importing all necessary libraries</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">scipy.stats</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">set_matplotlib_formats</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">set_matplotlib_formats</span><span class="p">(</span><span class="s1">&#39;svg&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_8969/4057771804.py:10: DeprecationWarning: `set_matplotlib_formats` is deprecated since IPython 7.23, directly use `matplotlib_inline.backend_inline.set_matplotlib_formats()`
  set_matplotlib_formats(&#39;svg&#39;)
</pre></div>
</div>
</div>
</div>
<p>in order to download datasets from kaggle, we need an API key to access their API, we’ll make that here</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">&#39;~/.kaggle&#39;</span><span class="p">)):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">&#39;~/.kaggle&#39;</span><span class="p">))</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">&#39;~/.kaggle/kaggle.json&#39;</span><span class="p">),</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;username&quot;</span><span class="p">:</span><span class="s2">&quot;lorenzf&quot;</span><span class="p">,</span>
            <span class="s2">&quot;key&quot;</span><span class="p">:</span><span class="s2">&quot;7a44a9e99b27e796177d793a3d85b8cf&quot;</span>
        <span class="p">}</span>
        <span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>now we can import kaggle too and download the datasets</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">kaggle</span>
<span class="n">kaggle</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">dataset_download_files</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="s1">&#39;pavellexyr/one-million-reddit-jokes&#39;</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s1">&#39;./data&#39;</span><span class="p">,</span> <span class="n">unzip</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">ipykernel_8969</span><span class="o">/</span><span class="mf">2979186203.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="kn">import</span> <span class="nn">kaggle</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">kaggle</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">dataset_download_files</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="s1">&#39;pavellexyr/one-million-reddit-jokes&#39;</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s1">&#39;./data&#39;</span><span class="p">,</span> <span class="n">unzip</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;kaggle&#39;
</pre></div>
</div>
</div>
</div>
<p>the csv files are now in the ‘./data’ folder, we can now read them using pandas, here is the list of all csv files in our folder</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s1">&#39;./data&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;WA_Fn-UseC_-Telco-Customer-Churn.csv&#39;,
 &#39;API_NY.GDP.PCAP.CD_DS2_en_csv_v2_3358201.csv&#39;,
 &#39;noc_regions.csv&#39;,
 &#39;freeFormResponses.csv&#39;,
 &#39;SurveySchema.csv&#39;,
 &#39;jester_ratings.csv&#39;,
 &#39;multipleChoiceResponses.csv&#39;,
 &#39;one-million-reddit-jokes.csv&#39;,
 &#39;jester_items.csv&#39;,
 &#39;athlete_events.csv&#39;,
 &#39;API_SP.POP.TOTL_DS2_en_csv_v2_3358390.csv&#39;]
</pre></div>
</div>
</div>
</div>
<p>With only one file in the dataset, we import it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reddit_jokes_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./data/one-million-reddit-jokes.csv&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;shape: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">reddit_jokes_df</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="n">reddit_jokes_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>shape: (1000000, 12)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>type</th>
      <th>id</th>
      <th>subreddit.id</th>
      <th>subreddit.name</th>
      <th>subreddit.nsfw</th>
      <th>created_utc</th>
      <th>permalink</th>
      <th>domain</th>
      <th>url</th>
      <th>selftext</th>
      <th>title</th>
      <th>score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>post</td>
      <td>ftbp1i</td>
      <td>2qh72</td>
      <td>jokes</td>
      <td>False</td>
      <td>1585785543</td>
      <td>https://old.reddit.com/r/Jokes/comments/ftbp1i...</td>
      <td>self.jokes</td>
      <td>NaN</td>
      <td>My corona is covered with foreskin so it is no...</td>
      <td>I am soooo glad I'm not circumcised!</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>post</td>
      <td>ftboup</td>
      <td>2qh72</td>
      <td>jokes</td>
      <td>False</td>
      <td>1585785522</td>
      <td>https://old.reddit.com/r/Jokes/comments/ftboup...</td>
      <td>self.jokes</td>
      <td>NaN</td>
      <td>It's called Google Sheets.</td>
      <td>Did you know Google now has a platform for rec...</td>
      <td>9</td>
    </tr>
    <tr>
      <th>2</th>
      <td>post</td>
      <td>ftbopj</td>
      <td>2qh72</td>
      <td>jokes</td>
      <td>False</td>
      <td>1585785508</td>
      <td>https://old.reddit.com/r/Jokes/comments/ftbopj...</td>
      <td>self.jokes</td>
      <td>NaN</td>
      <td>The vacuum doesn't snore after sex.\n\n&amp;amp;#x...</td>
      <td>What is the difference between my wife and my ...</td>
      <td>15</td>
    </tr>
    <tr>
      <th>3</th>
      <td>post</td>
      <td>ftbnxh</td>
      <td>2qh72</td>
      <td>jokes</td>
      <td>False</td>
      <td>1585785428</td>
      <td>https://old.reddit.com/r/Jokes/comments/ftbnxh...</td>
      <td>self.jokes</td>
      <td>NaN</td>
      <td>[removed]</td>
      <td>My last joke for now.</td>
      <td>9</td>
    </tr>
    <tr>
      <th>4</th>
      <td>post</td>
      <td>ftbjpg</td>
      <td>2qh72</td>
      <td>jokes</td>
      <td>False</td>
      <td>1585785009</td>
      <td>https://old.reddit.com/r/Jokes/comments/ftbjpg...</td>
      <td>self.jokes</td>
      <td>NaN</td>
      <td>[removed]</td>
      <td>The Nintendo 64 turns 18 this week...</td>
      <td>134</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Already we can see a lot of unnecessary information, so cleanup is important. It seems the joke is divided in a title and selftext where often the punchline is present.</p>
</div>
<div class="section" id="preparation">
<h2><span class="section-number">39.3. </span>Preparation<a class="headerlink" href="#preparation" title="Permalink to this headline">¶</a></h2>
<p>here we perform tasks to prepare the data in a more pleasing format.</p>
<div class="section" id="cleanup">
<h3><span class="section-number">39.3.1. </span>Cleanup<a class="headerlink" href="#cleanup" title="Permalink to this headline">¶</a></h3>
<p>First thing I would like to do see which columns are useless, by printing the amount of unique values</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">reddit_jokes_df</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">reddit_jokes_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>type
1

id
1000000

subreddit.id
1

subreddit.name
1

subreddit.nsfw
1

created_utc
996373

permalink
1000000

domain
364

url
4410

selftext
520567

title
861254

score
8913
</pre></div>
</div>
</div>
</div>
<p>a few columns only have 1 value, also the links are not important for our case, so we drop them too.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reddit_jokes_df</span> <span class="o">=</span> <span class="n">reddit_jokes_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;subreddit.id&#39;</span><span class="p">,</span> <span class="s1">&#39;subreddit.name&#39;</span><span class="p">,</span> <span class="s1">&#39;subreddit.nsfw&#39;</span><span class="p">,</span> <span class="s1">&#39;permalink&#39;</span><span class="p">,</span> <span class="s1">&#39;url&#39;</span><span class="p">])</span>
<span class="n">reddit_jokes_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>created_utc</th>
      <th>domain</th>
      <th>selftext</th>
      <th>title</th>
      <th>score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1585785543</td>
      <td>self.jokes</td>
      <td>My corona is covered with foreskin so it is no...</td>
      <td>I am soooo glad I'm not circumcised!</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1585785522</td>
      <td>self.jokes</td>
      <td>It's called Google Sheets.</td>
      <td>Did you know Google now has a platform for rec...</td>
      <td>9</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1585785508</td>
      <td>self.jokes</td>
      <td>The vacuum doesn't snore after sex.\n\n&amp;amp;#x...</td>
      <td>What is the difference between my wife and my ...</td>
      <td>15</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1585785428</td>
      <td>self.jokes</td>
      <td>[removed]</td>
      <td>My last joke for now.</td>
      <td>9</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1585785009</td>
      <td>self.jokes</td>
      <td>[removed]</td>
      <td>The Nintendo 64 turns 18 this week...</td>
      <td>134</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>much cleaner already!</p>
</div>
<div class="section" id="data-types">
<h3><span class="section-number">39.3.2. </span>Data Types<a class="headerlink" href="#data-types" title="Permalink to this headline">¶</a></h3>
<p>Before we do anything with our data, it is good to see if our data types are in order</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reddit_jokes_df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 1000000 entries, 0 to 999999
Data columns (total 5 columns):
 #   Column       Non-Null Count    Dtype 
---  ------       --------------    ----- 
 0   created_utc  1000000 non-null  int64 
 1   domain       1000000 non-null  object
 2   selftext     995525 non-null   object
 3   title        1000000 non-null  object
 4   score        1000000 non-null  int64 
dtypes: int64(2), object(3)
memory usage: 38.1+ MB
</pre></div>
</div>
</div>
</div>
<p>the created_utc feature is encoded in an unix timestamp, it would be more usefull to transform it to a timestamp</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reddit_jokes_df</span><span class="p">[</span><span class="s1">&#39;created&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">reddit_jokes_df</span><span class="p">[</span><span class="s1">&#39;created_utc&#39;</span><span class="p">],</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
<span class="k">del</span> <span class="n">reddit_jokes_df</span><span class="p">[</span><span class="s1">&#39;created_utc&#39;</span><span class="p">]</span>
<span class="n">reddit_jokes_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>domain</th>
      <th>selftext</th>
      <th>title</th>
      <th>score</th>
      <th>created</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>self.jokes</td>
      <td>My corona is covered with foreskin so it is no...</td>
      <td>I am soooo glad I'm not circumcised!</td>
      <td>2</td>
      <td>2020-04-01 23:59:03</td>
    </tr>
    <tr>
      <th>1</th>
      <td>self.jokes</td>
      <td>It's called Google Sheets.</td>
      <td>Did you know Google now has a platform for rec...</td>
      <td>9</td>
      <td>2020-04-01 23:58:42</td>
    </tr>
    <tr>
      <th>2</th>
      <td>self.jokes</td>
      <td>The vacuum doesn't snore after sex.\n\n&amp;amp;#x...</td>
      <td>What is the difference between my wife and my ...</td>
      <td>15</td>
      <td>2020-04-01 23:58:28</td>
    </tr>
    <tr>
      <th>3</th>
      <td>self.jokes</td>
      <td>[removed]</td>
      <td>My last joke for now.</td>
      <td>9</td>
      <td>2020-04-01 23:57:08</td>
    </tr>
    <tr>
      <th>4</th>
      <td>self.jokes</td>
      <td>[removed]</td>
      <td>The Nintendo 64 turns 18 this week...</td>
      <td>134</td>
      <td>2020-04-01 23:50:09</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="missing-values">
<h3><span class="section-number">39.3.3. </span>Missing values<a class="headerlink" href="#missing-values" title="Permalink to this headline">¶</a></h3>
<p>for each dataframe we apply a few checks in order to see the quality of data</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="n">reddit_jokes_df</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">/</span><span class="n">reddit_jokes_df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>domain      0.0000
selftext    0.4475
title       0.0000
score       0.0000
created     0.0000
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>it looks like some jokes are missing the selftext field, we show a few here.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reddit_jokes_df</span><span class="p">[</span><span class="n">reddit_jokes_df</span><span class="o">.</span><span class="n">selftext</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;score&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>domain</th>
      <th>selftext</th>
      <th>title</th>
      <th>score</th>
      <th>created</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>625315</th>
      <td>imgur.com</td>
      <td>NaN</td>
      <td>The funniest /r/jokes has ever been</td>
      <td>67950</td>
      <td>2017-05-20 15:41:28</td>
    </tr>
    <tr>
      <th>971313</th>
      <td>self.jokes</td>
      <td>NaN</td>
      <td>Ellen Pao's career</td>
      <td>36918</td>
      <td>2015-07-03 15:41:05</td>
    </tr>
    <tr>
      <th>942471</th>
      <td>self.jokes</td>
      <td>NaN</td>
      <td>If a woman sleeps with a bunch of guys, she's ...</td>
      <td>17486</td>
      <td>2015-10-05 16:09:09</td>
    </tr>
    <tr>
      <th>926550</th>
      <td>self.jokes</td>
      <td>NaN</td>
      <td>One in every 2 and a half men is HIV positive.</td>
      <td>17456</td>
      <td>2015-11-18 04:29:54</td>
    </tr>
    <tr>
      <th>919422</th>
      <td>self.jokes</td>
      <td>NaN</td>
      <td>Accordion to a recent survey, replacing words ...</td>
      <td>12580</td>
      <td>2015-12-07 18:55:27</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>929807</th>
      <td>self.jokes</td>
      <td>NaN</td>
      <td>9gag</td>
      <td>0</td>
      <td>2015-11-09 03:33:22</td>
    </tr>
    <tr>
      <th>959394</th>
      <td>self.jokes</td>
      <td>NaN</td>
      <td>Like flaming globes of Sigmund</td>
      <td>0</td>
      <td>2015-08-14 13:40:21</td>
    </tr>
    <tr>
      <th>929809</th>
      <td>self.jokes</td>
      <td>NaN</td>
      <td>On a scale of 10 to 10, how good am I at givin...</td>
      <td>0</td>
      <td>2015-11-09 03:26:55</td>
    </tr>
    <tr>
      <th>959338</th>
      <td>self.jokes</td>
      <td>NaN</td>
      <td>Who is Julius Caesar's favorite singer? Mark A...</td>
      <td>0</td>
      <td>2015-08-14 17:03:55</td>
    </tr>
    <tr>
      <th>999984</th>
      <td>self.jokes</td>
      <td>NaN</td>
      <td>One direction should be renamed 0.8 Direction</td>
      <td>0</td>
      <td>2015-03-26 19:57:54</td>
    </tr>
  </tbody>
</table>
<p>4475 rows × 5 columns</p>
</div></div></div>
</div>
<p>as far as I can see here the jokes are so short they are only one sentence, so we can fill in the missing values with an empty text.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reddit_jokes_df</span><span class="o">.</span><span class="n">selftext</span> <span class="o">=</span> <span class="n">reddit_jokes_df</span><span class="o">.</span><span class="n">selftext</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>This does not mean we are done, earlier I noticed the words [removed] and [deleted] in the selftext feature, indicating the joke was removed or deleted, these are missing values!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reddit_jokes_df</span><span class="p">[</span><span class="n">reddit_jokes_df</span><span class="o">.</span><span class="n">selftext</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;[removed]&#39;</span><span class="p">,</span> <span class="s1">&#39;[deleted]&#39;</span><span class="p">])]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>domain</th>
      <th>selftext</th>
      <th>title</th>
      <th>score</th>
      <th>created</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>self.jokes</td>
      <td>[removed]</td>
      <td>My last joke for now.</td>
      <td>9</td>
      <td>2020-04-01 23:57:08</td>
    </tr>
    <tr>
      <th>4</th>
      <td>self.jokes</td>
      <td>[removed]</td>
      <td>The Nintendo 64 turns 18 this week...</td>
      <td>134</td>
      <td>2020-04-01 23:50:09</td>
    </tr>
    <tr>
      <th>5</th>
      <td>self.jokes</td>
      <td>[removed]</td>
      <td>Sex with teacher.</td>
      <td>1</td>
      <td>2020-04-01 23:49:55</td>
    </tr>
    <tr>
      <th>6</th>
      <td>self.jokes</td>
      <td>[removed]</td>
      <td>Another long one.</td>
      <td>8</td>
      <td>2020-04-01 23:44:11</td>
    </tr>
    <tr>
      <th>8</th>
      <td>self.jokes</td>
      <td>[removed]</td>
      <td>A Priest takes a walk down to the docks one day</td>
      <td>88</td>
      <td>2020-04-01 23:39:27</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>I am going to remove these jokes as they are not complete anymore, it might have been that these jokes have been removed as they have already been posted.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reddit_jokes_df</span> <span class="o">=</span> <span class="n">reddit_jokes_df</span><span class="p">[</span><span class="o">~</span><span class="n">reddit_jokes_df</span><span class="o">.</span><span class="n">selftext</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;[removed]&#39;</span><span class="p">,</span> <span class="s1">&#39;[deleted]&#39;</span><span class="p">])]</span>
<span class="n">reddit_jokes_df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(578637, 5)
</pre></div>
</div>
</div>
</div>
<p>seems we have kept about 578k jokes, not bad!</p>
</div>
<div class="section" id="duplicates">
<h3><span class="section-number">39.3.4. </span>Duplicates<a class="headerlink" href="#duplicates" title="Permalink to this headline">¶</a></h3>
<p>As formatting of text might be different i’m not expecting a lot of duplicates, let’s see what we can find.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reddit_jokes_df</span><span class="p">[</span><span class="n">reddit_jokes_df</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;selftext&#39;</span><span class="p">])]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>domain</th>
      <th>selftext</th>
      <th>title</th>
      <th>score</th>
      <th>created</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>211</th>
      <td>self.jokes</td>
      <td>An academia nut..</td>
      <td>What do you call a nut that gets good grades?</td>
      <td>5</td>
      <td>2020-04-01 18:54:06</td>
    </tr>
    <tr>
      <th>4452</th>
      <td>self.jokes</td>
      <td>Repossssssssst</td>
      <td>If a snake who is on reddit has to comment a r...</td>
      <td>0</td>
      <td>2020-03-27 09:16:20</td>
    </tr>
    <tr>
      <th>6349</th>
      <td>self.jokes</td>
      <td>“To Japan,” replies her husband. \n\n“Oh my! T...</td>
      <td>A woman asks her husband where he’s taking the...</td>
      <td>4</td>
      <td>2020-03-25 00:48:09</td>
    </tr>
    <tr>
      <th>6881</th>
      <td>self.jokes</td>
      <td>Fortunately, I belong to the 1% of intelligent...</td>
      <td>99.9% of people are idiots.</td>
      <td>45135</td>
      <td>2020-03-24 09:40:14</td>
    </tr>
    <tr>
      <th>8299</th>
      <td>self.jokes</td>
      <td>You tell it a shitty joke.</td>
      <td>How do you get a toilet to laugh?</td>
      <td>0</td>
      <td>2020-03-22 07:49:45</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>999779</th>
      <td>self.jokes</td>
      <td>Dam.</td>
      <td>What did the fish say when he hit the wall?</td>
      <td>25</td>
      <td>2015-03-27 10:33:12</td>
    </tr>
    <tr>
      <th>999851</th>
      <td>self.jokes</td>
      <td>He tractor down.</td>
      <td>How did the farmer find his wife?</td>
      <td>58</td>
      <td>2015-03-27 02:42:29</td>
    </tr>
    <tr>
      <th>999882</th>
      <td>self.jokes</td>
      <td></td>
      <td>women's rights</td>
      <td>0</td>
      <td>2015-03-27 00:48:36</td>
    </tr>
    <tr>
      <th>999936</th>
      <td>self.jokes</td>
      <td>Don't be stupid, feminists can't change anything</td>
      <td>How many feminists does it take to change a li...</td>
      <td>24</td>
      <td>2015-03-26 22:00:06</td>
    </tr>
    <tr>
      <th>999979</th>
      <td>self.jokes</td>
      <td>Smoke</td>
      <td>What do you call a flying Jew?</td>
      <td>0</td>
      <td>2015-03-26 20:16:34</td>
    </tr>
  </tbody>
</table>
<p>12867 rows × 5 columns</p>
</div></div></div>
</div>
<p>A fair amount of jokes are reposted, so we keep the ones with the highest score.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span> <span class="n">reddit_jokes_df</span> <span class="o">=</span> <span class="n">reddit_jokes_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;score&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;selftext&#39;</span><span class="p">],</span> <span class="n">keep</span><span class="o">=</span><span class="s1">&#39;last&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="text-formatting">
<h3><span class="section-number">39.3.5. </span>Text formatting<a class="headerlink" href="#text-formatting" title="Permalink to this headline">¶</a></h3>
<p>Before we can analyze the text in the jokes we have to format it. We can do this by removing all special character and changing it all to lowercase</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;selftext&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">]:</span>
    <span class="n">reddit_jokes_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">reddit_jokes_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">to_replace</span><span class="o">=</span><span class="s2">&quot;[^a-zA-Z,.!? ]&quot;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

<span class="n">reddit_jokes_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>domain</th>
      <th>selftext</th>
      <th>title</th>
      <th>score</th>
      <th>created</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>630580</td>
      <td>self.jokes</td>
      <td>those who need closure,</td>
      <td>there are two kinds of people in the world.</td>
      <td>0</td>
      <td>2017-05-12 17:01:44</td>
    </tr>
    <tr>
      <th>1</th>
      <td>187066</td>
      <td>self.jokes</td>
      <td>so when someone asks you can say its .</td>
      <td>set your wifi password to</td>
      <td>0</td>
      <td>2019-05-28 00:30:46</td>
    </tr>
    <tr>
      <th>2</th>
      <td>437464</td>
      <td>self.jokes</td>
      <td>tooth hurty!</td>
      <td>at what time do you see your dentist?</td>
      <td>0</td>
      <td>2018-03-28 10:17:26</td>
    </tr>
    <tr>
      <th>3</th>
      <td>714598</td>
      <td>self.jokes</td>
      <td>where did you get a phone that works in spaini...</td>
      <td>john and juan are on lunch break when juans ph...</td>
      <td>0</td>
      <td>2017-01-13 02:37:59</td>
    </tr>
    <tr>
      <th>4</th>
      <td>187072</td>
      <td>self.jokes</td>
      <td>me how many am i allowed?guy only one me well ...</td>
      <td>a guy is handing out free fake mustaches on th...</td>
      <td>0</td>
      <td>2019-05-28 00:20:01</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Next we create a single joke by combining the title and selftext, this makes it easier to operate.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reddit_jokes_df</span><span class="p">[</span><span class="s1">&#39;joke&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">reddit_jokes_df</span><span class="o">.</span><span class="n">title</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">reddit_jokes_df</span><span class="o">.</span><span class="n">selftext</span>
<span class="n">reddit_jokes_df</span> <span class="o">=</span> <span class="n">reddit_jokes_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;selftext&#39;</span><span class="p">])</span>
<span class="n">reddit_jokes_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>domain</th>
      <th>score</th>
      <th>created</th>
      <th>joke</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>630580</td>
      <td>self.jokes</td>
      <td>0</td>
      <td>2017-05-12 17:01:44</td>
      <td>there are two kinds of people in the world. th...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>187066</td>
      <td>self.jokes</td>
      <td>0</td>
      <td>2019-05-28 00:30:46</td>
      <td>set your wifi password to  so when someone ask...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>437464</td>
      <td>self.jokes</td>
      <td>0</td>
      <td>2018-03-28 10:17:26</td>
      <td>at what time do you see your dentist? tooth hu...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>714598</td>
      <td>self.jokes</td>
      <td>0</td>
      <td>2017-01-13 02:37:59</td>
      <td>john and juan are on lunch break when juans ph...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>187072</td>
      <td>self.jokes</td>
      <td>0</td>
      <td>2019-05-28 00:20:01</td>
      <td>a guy is handing out free fake mustaches on th...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>
<div class="section" id="processing">
<h2><span class="section-number">39.4. </span>Processing<a class="headerlink" href="#processing" title="Permalink to this headline">¶</a></h2>
<div class="section" id="timing-of-joke">
<h3><span class="section-number">39.4.1. </span>Timing of joke<a class="headerlink" href="#timing-of-joke" title="Permalink to this headline">¶</a></h3>
<p>I would like to know if the timing of the jokes makes an impact on how funny the joke is, so i grouped based on both the weekday as well as the hour of day.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reddit_jokes_weekday</span> <span class="o">=</span> <span class="n">reddit_jokes_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">reddit_jokes_df</span><span class="o">.</span><span class="n">created</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">weekday</span><span class="p">)</span><span class="o">.</span><span class="n">score</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">])</span>
<span class="n">reddit_jokes_weekday</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean</th>
      <th>count</th>
    </tr>
    <tr>
      <th>created</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>226.871773</td>
      <td>79866</td>
    </tr>
    <tr>
      <th>1</th>
      <td>228.808886</td>
      <td>82940</td>
    </tr>
    <tr>
      <th>2</th>
      <td>222.802165</td>
      <td>84793</td>
    </tr>
    <tr>
      <th>3</th>
      <td>215.771594</td>
      <td>84932</td>
    </tr>
    <tr>
      <th>4</th>
      <td>222.888666</td>
      <td>82634</td>
    </tr>
    <tr>
      <th>5</th>
      <td>232.752534</td>
      <td>75089</td>
    </tr>
    <tr>
      <th>6</th>
      <td>241.322581</td>
      <td>75516</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reddit_jokes_hour</span> <span class="o">=</span> <span class="n">reddit_jokes_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">reddit_jokes_df</span><span class="o">.</span><span class="n">created</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">hour</span><span class="p">)</span><span class="o">.</span><span class="n">score</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">])</span>
<span class="n">reddit_jokes_hour</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean</th>
      <th>count</th>
    </tr>
    <tr>
      <th>created</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>189.177767</td>
      <td>25646</td>
    </tr>
    <tr>
      <th>1</th>
      <td>189.383726</td>
      <td>25440</td>
    </tr>
    <tr>
      <th>2</th>
      <td>172.406772</td>
      <td>25368</td>
    </tr>
    <tr>
      <th>3</th>
      <td>140.741126</td>
      <td>23637</td>
    </tr>
    <tr>
      <th>4</th>
      <td>144.066960</td>
      <td>21162</td>
    </tr>
    <tr>
      <th>5</th>
      <td>137.355467</td>
      <td>19006</td>
    </tr>
    <tr>
      <th>6</th>
      <td>168.542319</td>
      <td>16671</td>
    </tr>
    <tr>
      <th>7</th>
      <td>214.903014</td>
      <td>15198</td>
    </tr>
    <tr>
      <th>8</th>
      <td>271.710558</td>
      <td>14217</td>
    </tr>
    <tr>
      <th>9</th>
      <td>398.431366</td>
      <td>14009</td>
    </tr>
    <tr>
      <th>10</th>
      <td>456.262600</td>
      <td>15952</td>
    </tr>
    <tr>
      <th>11</th>
      <td>446.946555</td>
      <td>18056</td>
    </tr>
    <tr>
      <th>12</th>
      <td>404.759640</td>
      <td>21447</td>
    </tr>
    <tr>
      <th>13</th>
      <td>318.348451</td>
      <td>24342</td>
    </tr>
    <tr>
      <th>14</th>
      <td>263.100078</td>
      <td>26899</td>
    </tr>
    <tr>
      <th>15</th>
      <td>227.382529</td>
      <td>28322</td>
    </tr>
    <tr>
      <th>16</th>
      <td>204.701879</td>
      <td>29327</td>
    </tr>
    <tr>
      <th>17</th>
      <td>185.274719</td>
      <td>29623</td>
    </tr>
    <tr>
      <th>18</th>
      <td>210.557595</td>
      <td>29369</td>
    </tr>
    <tr>
      <th>19</th>
      <td>194.320871</td>
      <td>29342</td>
    </tr>
    <tr>
      <th>20</th>
      <td>194.809965</td>
      <td>29063</td>
    </tr>
    <tr>
      <th>21</th>
      <td>179.245679</td>
      <td>29099</td>
    </tr>
    <tr>
      <th>22</th>
      <td>198.723083</td>
      <td>27817</td>
    </tr>
    <tr>
      <th>23</th>
      <td>179.602399</td>
      <td>26758</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="bag-of-words">
<h3><span class="section-number">39.4.2. </span>Bag of words<a class="headerlink" href="#bag-of-words" title="Permalink to this headline">¶</a></h3>
<p>To be able to work with the words in our joke, we create a bag of words dataframe, where for each word and joke combination a count is kept of how many times the word is present in that joke. Notice that stopwords are removed.</p>
<p>First we split each joke up in words</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">joke_words</span> <span class="o">=</span> <span class="n">reddit_jokes_df</span><span class="o">.</span><span class="n">joke</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<span class="n">joke_words</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    [there, are, two, kinds, of, people, in, the, ...
1    [set, your, wifi, password, to, , so, when, so...
2    [at, what, time, do, you, see, your, dentist?,...
3    [john, and, juan, are, on, lunch, break, when,...
4    [a, guy, is, handing, out, free, fake, mustach...
Name: joke, dtype: object
</pre></div>
</div>
</div>
</div>
<p>Next we use the nltk toolkit to get a list of english stopwords.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">nltk</span>
<span class="n">nltk</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s1">&#39;stopwords&#39;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">nltk.corpus</span> <span class="kn">import</span> <span class="n">stopwords</span>
<span class="n">stopwords</span><span class="o">.</span><span class="n">words</span><span class="p">(</span><span class="s1">&#39;english&#39;</span><span class="p">)[:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[nltk_data] Downloading package stopwords to
[nltk_data]     /home/lorenzf/nltk_data...
[nltk_data]   Package stopwords is already up-to-date!
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;i&#39;, &#39;me&#39;, &#39;my&#39;, &#39;myself&#39;, &#39;we&#39;]
</pre></div>
</div>
</div>
</div>
<p>We remove all the stopwords from the jokes, now the jokes have a handicapped grammar.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">joke_words</span> <span class="o">=</span> <span class="n">joke_words</span><span class="o">.</span><span class="n">head</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="p">[</span><span class="n">word</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">x</span> <span class="k">if</span> <span class="n">word</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">stopwords</span><span class="o">.</span><span class="n">words</span><span class="p">(</span><span class="s1">&#39;english&#39;</span><span class="p">)])</span>
<span class="n">joke_words</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0         [two, kinds, people, world., need, closure,]
1       [set, wifi, password, , someone, asks, say, .]
2                 [time, see, dentist?, tooth, hurty!]
3    [john, juan, lunch, break, juans, phone, rings...
4    [guy, handing, free, fake, mustaches, street, ...
Name: joke, dtype: object
</pre></div>
</div>
</div>
</div>
<p>Finally we are going to use sklearn and the CountVectorizer to create the BoW vector, this is a sparse matrix as most words are not appearing in most jokes.
This means we cannot visualise the matrix, or our computer would explode.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">CountVectorizer</span>

<span class="n">cnt_vect</span> <span class="o">=</span> <span class="n">CountVectorizer</span><span class="p">(</span><span class="n">analyzer</span><span class="o">=</span><span class="s2">&quot;word&quot;</span><span class="p">,</span> <span class="n">stop_words</span><span class="o">=</span><span class="n">stopwords</span><span class="o">.</span><span class="n">words</span><span class="p">(</span><span class="s1">&#39;english&#39;</span><span class="p">),</span> <span class="n">max_features</span><span class="o">=</span><span class="mi">20000</span><span class="p">)</span> 

<span class="n">bow_jokes</span> <span class="o">=</span> <span class="n">cnt_vect</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">reddit_jokes_df</span><span class="o">.</span><span class="n">joke</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bow_jokes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;565770x20000 sparse matrix of type &#39;&lt;class &#39;numpy.int64&#39;&gt;&#39;
	with 9101120 stored elements in Compressed Sparse Row format&gt;
</pre></div>
</div>
</div>
</div>
<p>But we can fetch the vocabulary of our bag, which starts with a lot of weird words, indicating we might have chosen too many features</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cnt_vect</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">()[:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;aa&#39;, &#39;aaa&#39;, &#39;aaah&#39;, &#39;aah&#39;, &#39;aardvark&#39;, &#39;aaron&#39;, &#39;ab&#39;, &#39;aback&#39;,
       &#39;abacus&#39;, &#39;abandon&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="term-frequency-inverse-document-frequency">
<h3><span class="section-number">39.4.3. </span>Term Frequency - Inverse Document Frequency<a class="headerlink" href="#term-frequency-inverse-document-frequency" title="Permalink to this headline">¶</a></h3>
<p>Another interesting method is the tf-idf matrix, where each occurence is weighted by the overall frequency of that word. If a word is used often over all jokes, it won’t be as important, but if a word is used infrequent it is more important.</p>
<p>Again we use sklearn to vectorize our jokes</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">TfidfVectorizer</span>
<span class="n">tfidf_vect</span> <span class="o">=</span> <span class="n">TfidfVectorizer</span><span class="p">()</span>
<span class="n">tfidf_jokes</span> <span class="o">=</span> <span class="n">tfidf_vect</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">reddit_jokes_df</span><span class="o">.</span><span class="n">joke</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">tfidf_jokes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;565770x196601 sparse matrix of type &#39;&lt;class &#39;numpy.float64&#39;&gt;&#39;
	with 15153814 stored elements in Compressed Sparse Row format&gt;
</pre></div>
</div>
</div>
</div>
<p>we can create a quick dataframe to interpret the result, for each word in our dataset we retrieve the inverse document frequency, a high idf means a unique word.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">idf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">{</span>
      <span class="s1">&#39;term&#39;</span><span class="p">:</span> <span class="n">tfidf_vect</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">(),</span>
      <span class="s1">&#39;idf&#39;</span><span class="p">:</span> <span class="n">tfidf_vect</span><span class="o">.</span><span class="n">idf_</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">)</span>
<span class="n">idf</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>term</th>
      <th>idf</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>aa</td>
      <td>10.026437</td>
    </tr>
    <tr>
      <th>1</th>
      <td>aaa</td>
      <td>10.275653</td>
    </tr>
    <tr>
      <th>2</th>
      <td>aaaa</td>
      <td>12.454185</td>
    </tr>
    <tr>
      <th>3</th>
      <td>aaaaa</td>
      <td>13.147332</td>
    </tr>
    <tr>
      <th>4</th>
      <td>aaaaaa</td>
      <td>13.552798</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>When we sort them by idf we can find the most unique words, yet it doesn’t seem to be useful at the moment.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">idf</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;idf&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>term</th>
      <th>idf</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>196600</th>
      <td>zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzthe</td>
      <td>13.552798</td>
    </tr>
    <tr>
      <th>110080</th>
      <td>misterunderstanding</td>
      <td>13.552798</td>
    </tr>
    <tr>
      <th>110074</th>
      <td>misterectomy</td>
      <td>13.552798</td>
    </tr>
    <tr>
      <th>110075</th>
      <td>misterious</td>
      <td>13.552798</td>
    </tr>
    <tr>
      <th>110076</th>
      <td>misterjmyers</td>
      <td>13.552798</td>
    </tr>
    <tr>
      <th>110077</th>
      <td>misterlee</td>
      <td>13.552798</td>
    </tr>
    <tr>
      <th>110078</th>
      <td>misterogyny</td>
      <td>13.552798</td>
    </tr>
    <tr>
      <th>110079</th>
      <td>misters</td>
      <td>13.552798</td>
    </tr>
    <tr>
      <th>110081</th>
      <td>misterunderstood</td>
      <td>13.552798</td>
    </tr>
    <tr>
      <th>110072</th>
      <td>misterapproximate</td>
      <td>13.552798</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>
<div class="section" id="exploration">
<h2><span class="section-number">39.5. </span>Exploration<a class="headerlink" href="#exploration" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">good_jokes</span> <span class="o">=</span> <span class="n">reddit_jokes_df</span><span class="p">[</span><span class="n">reddit_jokes_df</span><span class="o">.</span><span class="n">score</span><span class="o">&gt;</span><span class="mi">10000</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">good_jokes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>domain</th>
      <th>score</th>
      <th>created</th>
      <th>joke</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>562291</th>
      <td>766392</td>
      <td>self.jokes</td>
      <td>10003</td>
      <td>2016-11-05 12:19:21</td>
      <td>a joke my grandma told me before she passed. s...</td>
    </tr>
    <tr>
      <th>562292</th>
      <td>817060</td>
      <td>self.jokes</td>
      <td>10013</td>
      <td>2016-08-15 23:23:22</td>
      <td>if a woman sleeps with  men shes a slut, but i...</td>
    </tr>
    <tr>
      <th>562293</th>
      <td>956485</td>
      <td>self.jokes</td>
      <td>10017</td>
      <td>2015-08-23 14:31:29</td>
      <td>how many germans does it take to change a ligh...</td>
    </tr>
    <tr>
      <th>562294</th>
      <td>672977</td>
      <td>self.jokes</td>
      <td>10018</td>
      <td>2017-03-12 10:30:11</td>
      <td>a man and his wife are awakened at  oclock in ...</td>
    </tr>
    <tr>
      <th>562295</th>
      <td>207962</td>
      <td>self.jokes</td>
      <td>10019</td>
      <td>2019-04-24 23:06:14</td>
      <td>my least favorite color is purple. i hate it m...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>565765</th>
      <td>329338</td>
      <td>self.jokes</td>
      <td>98257</td>
      <td>2018-10-08 13:53:47</td>
      <td>a new navy recruit has his first day on the su...</td>
    </tr>
    <tr>
      <th>565766</th>
      <td>141894</td>
      <td>self.jokes</td>
      <td>103652</td>
      <td>2019-08-10 15:03:25</td>
      <td>if your surprised that jeffrey epstein commite...</td>
    </tr>
    <tr>
      <th>565767</th>
      <td>596220</td>
      <td>self.jokes</td>
      <td>106412</td>
      <td>2017-07-05 18:01:05</td>
      <td>v vedit seems like the ctrl key on my keyboard...</td>
    </tr>
    <tr>
      <th>565768</th>
      <td>511072</td>
      <td>self.jokes</td>
      <td>136359</td>
      <td>2017-11-21 20:15:27</td>
      <td>calm down about the net neutrality thing... pa...</td>
    </tr>
    <tr>
      <th>565769</th>
      <td>29360</td>
      <td>self.jokes</td>
      <td>142733</td>
      <td>2020-02-20 01:51:00</td>
      <td>sad news the founder of rjokes has passed away...</td>
    </tr>
  </tbody>
</table>
<p>3479 rows × 5 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">good_jokes_word_cnt</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">cnt_vect</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">()),</span>
        <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">bow_jokes</span><span class="p">[</span><span class="n">good_jokes</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()),</span>
    <span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;word&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">good_jokes_word_cnt</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>word</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>aa</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>aaa</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>aaah</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>aah</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>aardvark</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>19995</th>
      <td>zoos</td>
      <td>0</td>
    </tr>
    <tr>
      <th>19996</th>
      <td>zs</td>
      <td>0</td>
    </tr>
    <tr>
      <th>19997</th>
      <td>zucchini</td>
      <td>0</td>
    </tr>
    <tr>
      <th>19998</th>
      <td>zuckerberg</td>
      <td>1</td>
    </tr>
    <tr>
      <th>19999</th>
      <td>zwei</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>20000 rows × 2 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">good_jokes_word_cnt</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>word</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>15199</th>
      <td>says</td>
      <td>1647</td>
    </tr>
    <tr>
      <th>10528</th>
      <td>man</td>
      <td>1405</td>
    </tr>
    <tr>
      <th>15050</th>
      <td>said</td>
      <td>1196</td>
    </tr>
    <tr>
      <th>12100</th>
      <td>one</td>
      <td>1057</td>
    </tr>
    <tr>
      <th>8673</th>
      <td>im</td>
      <td>833</td>
    </tr>
    <tr>
      <th>7278</th>
      <td>get</td>
      <td>717</td>
    </tr>
    <tr>
      <th>19559</th>
      <td>wife</td>
      <td>669</td>
    </tr>
    <tr>
      <th>10101</th>
      <td>like</td>
      <td>656</td>
    </tr>
    <tr>
      <th>5190</th>
      <td>dont</td>
      <td>632</td>
    </tr>
    <tr>
      <th>19416</th>
      <td>well</td>
      <td>626</td>
    </tr>
    <tr>
      <th>1211</th>
      <td>back</td>
      <td>626</td>
    </tr>
    <tr>
      <th>953</th>
      <td>asks</td>
      <td>607</td>
    </tr>
    <tr>
      <th>947</th>
      <td>asked</td>
      <td>586</td>
    </tr>
    <tr>
      <th>19762</th>
      <td>would</td>
      <td>564</td>
    </tr>
    <tr>
      <th>9692</th>
      <td>know</td>
      <td>562</td>
    </tr>
    <tr>
      <th>7779</th>
      <td>guy</td>
      <td>518</td>
    </tr>
    <tr>
      <th>7388</th>
      <td>go</td>
      <td>492</td>
    </tr>
    <tr>
      <th>4463</th>
      <td>day</td>
      <td>481</td>
    </tr>
    <tr>
      <th>19689</th>
      <td>woman</td>
      <td>479</td>
    </tr>
    <tr>
      <th>7473</th>
      <td>got</td>
      <td>461</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">joke</span> <span class="ow">in</span> <span class="n">good_jokes</span><span class="p">[</span><span class="n">good_jokes</span><span class="o">.</span><span class="n">joke</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39; man &#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">joke</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">joke</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a man in an interrogation room says im not saying a word without my lawyer present. cop you are the lawyer. lawyer exactly, so wheres my present?

christmas joke nsfw a  year old male walks into a drug store. he says ive been invited to christmas dinner at my new girlfriends house. afterwards i hope there is a chance i get lucky, you know what i mean clerk how about condoms then? they could come in handy. heres a pack. the young man after paying walks to the door, stops, smiles, comes back you know what, the mom is also smoking hot, i think ill take another pack, just in case i get extra lucky.christmas eve comes around, the boy sits at the dinner table and doesnt say a word. after a while his girlfriend says if i had known you were so quiet, i wouldnt have invited you. the young man replies if you had told me your dad works at a drug store, i wouldnt have come.

my favorite joke everyone knows dave dave was bragging to his boss one day, you know, i know everyone there is to know. just name someone, anyone, and i know them.tired of his boasting, his boss called his bluff, ok, dave, how about tom cruise?no dramas boss, tom and i are old friends, and i can prove it.so dave and his boss fly out to hollywood and knock on tom cruises door, and tom cruise shouts, dave! whats happening? great to see you! come on in for a beer!although impressed, daves boss is still skeptical. after they leave cruises house, he tells dave that he thinks him knowing cruise was just lucky.no, no, just name anyone else, dave says.president obama, his boss quickly retorts.yup, dave says, old buddies, lets fly out to washington, and off they go. at the white house, obama spots dave on the tour and motions him and his boss over, saying, dave, what a surprise, i was just on my way to a meeting, but you and your friend come on in and lets have a beer first and catch up.well, the boss is very shaken by now but still not totally convinced.after they leave the white house grounds he expresses his doubts to dave, who again implores him to name anyone else.pope francis, his boss replies.sure! says dave. ive known the pope for years. so off they fly to rome.dave and his boss are assembled with the masses at the vaticans st. peters square when dave says, this will never work. i cant catch the popes eye among all these people. tell you what, i know all the guards so let me just go upstairs and ill come out on the balcony with the pope.he disappears into the crowd headed towards the vatican.sure enough, half an hour later dave emerges with the pope on the balcony, but by the time dave returns, he finds that his boss has had a heart attack and is surrounded by paramedics.making his way to his boss side, dave asks him, what happened?his boss looks up and says, it was the final straw... you and the pope came out on to the balcony and the man next to me said, who the fuck is that on the balcony with dave?

by legalizing cannabis and samesex marriage we finally interpreted the bible correctly a man who lays with another man should be stoned. leviticus  esv edit a typo edit thanks for the gold humorous stranger! 

a man walks into a bar... the bartender asks why the long face? the man replies i just found out my wife is sleeping with another man. ive decided im going to drink myself to death. the bartender looks shocked and says im sorry i cant help you kill yourself. the man asks well what would you do in my situation?the bartender puffs himself up a bit and says if i found out a guy was sleeping with my wife i wouldnt sit around feeling sorry for myself, id kill the guy.the man jumps up from his stool and shouts thats a great idea! thanks! and runs out of the bar.a couple hours goes by and the bartender is starting to get nervous when the man walks back into the bar with a smile on his face.did you kill the guy? the bartender asks nervously.nope! i slept with your wife. whiskey please.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">good_jokes_word_idf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">tfidf_vect</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">()),</span>
        <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">tfidf_jokes</span><span class="p">[</span><span class="n">good_jokes</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()),</span>
    <span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;word&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">good_jokes_word_idf</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>word</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>aa</td>
      <td>0.218800</td>
    </tr>
    <tr>
      <th>1</th>
      <td>aaa</td>
      <td>0.337332</td>
    </tr>
    <tr>
      <th>2</th>
      <td>aaaa</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>aaaaa</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>aaaaaa</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>196596</th>
      <td>zzzzzzzzzzzzzzzzz</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>196597</th>
      <td>zzzzzzzzzzzzzzzzzzzzzz</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>196598</th>
      <td>zzzzzzzzzzzzzzzzzzzzzzzzzzzzzthe</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>196599</th>
      <td>zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzthe</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>196600</th>
      <td>zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzthe</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
<p>196601 rows × 2 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">good_jokes_word_idf</span><span class="p">[</span><span class="o">~</span><span class="n">good_jokes_word_idf</span><span class="o">.</span><span class="n">word</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">stopwords</span><span class="o">.</span><span class="n">words</span><span class="p">(</span><span class="s1">&#39;english&#39;</span><span class="p">))]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>word</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>147669</th>
      <td>said</td>
      <td>67.537998</td>
    </tr>
    <tr>
      <th>149360</th>
      <td>says</td>
      <td>64.319957</td>
    </tr>
    <tr>
      <th>103769</th>
      <td>man</td>
      <td>57.291711</td>
    </tr>
    <tr>
      <th>85108</th>
      <td>im</td>
      <td>51.772732</td>
    </tr>
    <tr>
      <th>190313</th>
      <td>wife</td>
      <td>51.119043</td>
    </tr>
    <tr>
      <th>121680</th>
      <td>one</td>
      <td>50.363516</td>
    </tr>
    <tr>
      <th>99600</th>
      <td>like</td>
      <td>44.929305</td>
    </tr>
    <tr>
      <th>69195</th>
      <td>get</td>
      <td>43.785308</td>
    </tr>
    <tr>
      <th>53561</th>
      <td>edit</td>
      <td>41.610126</td>
    </tr>
    <tr>
      <th>50077</th>
      <td>dont</td>
      <td>41.495084</td>
    </tr>
    <tr>
      <th>11555</th>
      <td>asked</td>
      <td>39.825113</td>
    </tr>
    <tr>
      <th>95238</th>
      <td>know</td>
      <td>34.931383</td>
    </tr>
    <tr>
      <th>192780</th>
      <td>would</td>
      <td>33.093493</td>
    </tr>
    <tr>
      <th>71679</th>
      <td>got</td>
      <td>32.481152</td>
    </tr>
    <tr>
      <th>188359</th>
      <td>well</td>
      <td>31.715616</td>
    </tr>
    <tr>
      <th>74211</th>
      <td>guy</td>
      <td>31.570352</td>
    </tr>
    <tr>
      <th>14528</th>
      <td>back</td>
      <td>30.231193</td>
    </tr>
    <tr>
      <th>153190</th>
      <td>sex</td>
      <td>28.914655</td>
    </tr>
    <tr>
      <th>191722</th>
      <td>woman</td>
      <td>28.747487</td>
    </tr>
    <tr>
      <th>128249</th>
      <td>people</td>
      <td>28.045112</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tfidf_good_vect</span> <span class="o">=</span> <span class="n">TfidfVectorizer</span><span class="p">()</span>
<span class="n">tfidf_good_jokes</span> <span class="o">=</span> <span class="n">tfidf_good_vect</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">good_jokes</span><span class="o">.</span><span class="n">joke</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">tfidf_good_jokes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;3479x13866 sparse matrix of type &#39;&lt;class &#39;numpy.float64&#39;&gt;&#39;
	with 158145 stored elements in Compressed Sparse Row format&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">good_jokes_word_idf</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">tfidf_good_vect</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">()),</span>
        <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">tfidf_good_jokes</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()),</span>
    <span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;word&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">good_jokes_word_idf</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>word</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>aa</td>
      <td>0.217575</td>
    </tr>
    <tr>
      <th>1</th>
      <td>aaa</td>
      <td>0.387436</td>
    </tr>
    <tr>
      <th>2</th>
      <td>aaaah</td>
      <td>0.085922</td>
    </tr>
    <tr>
      <th>3</th>
      <td>aaarrrghh</td>
      <td>0.316697</td>
    </tr>
    <tr>
      <th>4</th>
      <td>aaaway</td>
      <td>0.318949</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>13861</th>
      <td>zoobooks</td>
      <td>0.237976</td>
    </tr>
    <tr>
      <th>13862</th>
      <td>zookeeper</td>
      <td>0.409659</td>
    </tr>
    <tr>
      <th>13863</th>
      <td>zoophile</td>
      <td>0.203000</td>
    </tr>
    <tr>
      <th>13864</th>
      <td>zuckerberg</td>
      <td>0.352931</td>
    </tr>
    <tr>
      <th>13865</th>
      <td>zwei</td>
      <td>0.142169</td>
    </tr>
  </tbody>
</table>
<p>13866 rows × 2 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">good_jokes_word_idf</span><span class="p">[</span><span class="o">~</span><span class="n">good_jokes_word_idf</span><span class="o">.</span><span class="n">word</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">stopwords</span><span class="o">.</span><span class="n">words</span><span class="p">(</span><span class="s1">&#39;english&#39;</span><span class="p">))]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>word</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10299</th>
      <td>said</td>
      <td>61.751454</td>
    </tr>
    <tr>
      <th>10407</th>
      <td>says</td>
      <td>60.323491</td>
    </tr>
    <tr>
      <th>7268</th>
      <td>man</td>
      <td>58.135122</td>
    </tr>
    <tr>
      <th>8314</th>
      <td>one</td>
      <td>49.662388</td>
    </tr>
    <tr>
      <th>6025</th>
      <td>im</td>
      <td>49.230105</td>
    </tr>
    <tr>
      <th>13533</th>
      <td>wife</td>
      <td>47.633648</td>
    </tr>
    <tr>
      <th>6978</th>
      <td>like</td>
      <td>45.431302</td>
    </tr>
    <tr>
      <th>5084</th>
      <td>get</td>
      <td>43.641674</td>
    </tr>
    <tr>
      <th>3600</th>
      <td>dont</td>
      <td>40.811579</td>
    </tr>
    <tr>
      <th>717</th>
      <td>asked</td>
      <td>36.849412</td>
    </tr>
    <tr>
      <th>6697</th>
      <td>know</td>
      <td>34.773909</td>
    </tr>
    <tr>
      <th>5422</th>
      <td>guy</td>
      <td>32.166281</td>
    </tr>
    <tr>
      <th>5227</th>
      <td>got</td>
      <td>31.952154</td>
    </tr>
    <tr>
      <th>13694</th>
      <td>would</td>
      <td>31.815714</td>
    </tr>
    <tr>
      <th>13404</th>
      <td>well</td>
      <td>29.399329</td>
    </tr>
    <tr>
      <th>8758</th>
      <td>people</td>
      <td>29.100171</td>
    </tr>
    <tr>
      <th>3846</th>
      <td>edit</td>
      <td>29.063515</td>
    </tr>
    <tr>
      <th>10666</th>
      <td>sex</td>
      <td>28.859416</td>
    </tr>
    <tr>
      <th>918</th>
      <td>back</td>
      <td>28.349291</td>
    </tr>
    <tr>
      <th>3092</th>
      <td>day</td>
      <td>28.040213</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">KMeans</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">kmeans</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">tfidf_good_jokes</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>KMeans(n_clusters=100)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">good_jokes</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">labels_</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">good_jokes</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>domain</th>
      <th>score</th>
      <th>created</th>
      <th>joke</th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>562291</th>
      <td>766392</td>
      <td>self.jokes</td>
      <td>10003</td>
      <td>2016-11-05 12:19:21</td>
      <td>a joke my grandma told me before she passed. s...</td>
      <td>10</td>
    </tr>
    <tr>
      <th>562292</th>
      <td>817060</td>
      <td>self.jokes</td>
      <td>10013</td>
      <td>2016-08-15 23:23:22</td>
      <td>if a woman sleeps with  men shes a slut, but i...</td>
      <td>35</td>
    </tr>
    <tr>
      <th>562293</th>
      <td>956485</td>
      <td>self.jokes</td>
      <td>10017</td>
      <td>2015-08-23 14:31:29</td>
      <td>how many germans does it take to change a ligh...</td>
      <td>30</td>
    </tr>
    <tr>
      <th>562294</th>
      <td>672977</td>
      <td>self.jokes</td>
      <td>10018</td>
      <td>2017-03-12 10:30:11</td>
      <td>a man and his wife are awakened at  oclock in ...</td>
      <td>19</td>
    </tr>
    <tr>
      <th>562295</th>
      <td>207962</td>
      <td>self.jokes</td>
      <td>10019</td>
      <td>2019-04-24 23:06:14</td>
      <td>my least favorite color is purple. i hate it m...</td>
      <td>73</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">jokes_cluster_counts</span> <span class="o">=</span> <span class="n">good_jokes</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="n">jokes_cluster_counts</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>22    356
19    312
5     211
10    166
65     95
     ... 
33      8
71      8
55      7
13      7
27      6
Name: label, Length: 100, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">joke</span> <span class="ow">in</span> <span class="n">good_jokes</span><span class="p">[</span><span class="n">good_jokes</span><span class="o">.</span><span class="n">label</span><span class="o">==</span><span class="n">jokes_cluster_counts</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;score&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">joke</span><span class="o">.</span><span class="n">head</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">joke</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>calm down about the net neutrality thing... paying additional money to access certain sites will give you a sense of pride and accomplishment.

why was the antivaxxers  year old child crying? midlife crisis

all countries eventually got coronavirus but china got it right off the bat.

as an aussie, americans are always asking me where in australia there isnt something trying to kill you... school is my answer 

a feminist told me about the dwayne johnson rule. the rule, as she explained it, was that in order to determine if a particular comment was appropriate to say to a woman, first ask yourself, would i be comfortable saying this to dwayne johnson? if not, dont say it.i thought this sounded like a good rule. so i told heryour chest is fucking epic.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">joke</span> <span class="ow">in</span> <span class="n">good_jokes</span><span class="p">[</span><span class="n">good_jokes</span><span class="o">.</span><span class="n">label</span><span class="o">==</span><span class="n">jokes_cluster_counts</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;score&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">joke</span><span class="o">.</span><span class="n">head</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">joke</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>i take viagra for my sun burn... it doesnt cure it, but it keeps the sheets off my legs when i sleep.ampxb

what rhymes with orange no it doesnt

im taking viagra for my sunburn. it doesnt cure it, but it keeps the sheets off of my legs

ive been taking viagra for my sunburn doesnt cure it, but it keeps the sheets off my legs at night.

im taking viagra for my sunburn it doesnt cure it, but it keeps the sheets off my legs
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kaggle</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">dataset_download_files</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="s1">&#39;vikashrajluhaniwal/jester-17m-jokes-ratings-dataset&#39;</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s1">&#39;./data&#39;</span><span class="p">,</span> <span class="n">unzip</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">jester_jokes_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./data/jester_items.csv&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;shape: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">jester_jokes_df</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="n">jester_jokes_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>shape: (150, 2)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>jokeId</th>
      <th>jokeText</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>A man visits the doctor. The doctor says "I ha...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>This couple had an excellent relationship goin...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Q. What's 200 feet long and has 4 teeth? \n\nA...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Q. What's the difference between a man and a t...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>Q.\tWhat's O. J. Simpson's Internet address? \...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">jester_ratings_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./data/jester_ratings.csv&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;shape: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">jester_ratings_df</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="n">jester_ratings_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>shape: (1761439, 3)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>userId</th>
      <th>jokeId</th>
      <th>rating</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>5</td>
      <td>0.219</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>7</td>
      <td>-9.281</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>8</td>
      <td>-9.281</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>13</td>
      <td>-6.781</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>15</td>
      <td>0.875</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">jester_ratings_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;jokeId&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rating</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>jokeId
5     -1.756331
7     -1.809230
8     -0.672010
13    -0.590224
15    -1.377098
         ...   
146    0.178280
147    1.783395
148    3.061760
149    2.399796
150    2.810758
Name: rating, Length: 140, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">jester_sorted</span> <span class="o">=</span> <span class="n">jester_ratings_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;jokeId&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rating</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">jester_jokes_df</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;rating&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">jester_sorted</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>rating</th>
      <th>jokeId</th>
      <th>jokeText</th>
    </tr>
    <tr>
      <th>jokeId</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>53</th>
      <td>3.714381</td>
      <td>54.0</td>
      <td>The Pope dies and, naturally, goes to heaven. ...</td>
    </tr>
    <tr>
      <th>105</th>
      <td>3.711223</td>
      <td>106.0</td>
      <td>An engineer dies and reports to the pearly gat...</td>
    </tr>
    <tr>
      <th>89</th>
      <td>3.606506</td>
      <td>90.0</td>
      <td>Q: How many programmers does it take to change...</td>
    </tr>
    <tr>
      <th>129</th>
      <td>3.583496</td>
      <td>130.0</td>
      <td>An old man goes to the doctor for his yearly p...</td>
    </tr>
    <tr>
      <th>35</th>
      <td>3.560305</td>
      <td>36.0</td>
      <td>A guy walks into a bar, orders a beer and says...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">joke</span> <span class="ow">in</span> <span class="n">jester_sorted</span><span class="o">.</span><span class="n">head</span><span class="p">()</span><span class="o">.</span><span class="n">jokeText</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">joke</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The Pope dies and, naturally, goes to heaven. He&#39;s met by the reception
committee, and after a whirlwind tour he is told that he can enjoy any
of the myriad of recreations available.
He decides that he wants to read all of the ancient original text of the
Holy Scriptures, so he spends the next eon or so learning languages.
After becoming a linguistic master, he sits down in the library and
begins to pour over every version of the Bible, working back from most
recent &quot;Easy Reading&quot; to the original script.
All of a sudden there is a scream in the library. The Angels come
running in only to find the Pope huddled in his chair, crying to himself
and muttering, &quot;An &#39;R&#39;! The scribes left out the &#39;R&#39;.&quot; 
A particularly concerned Angel takes him aside, offering comfort, asks
him what the problem is and what does he mean. 
After collecting his
wits, the Pope sobs again, &quot;It&#39;s the letter &#39;R&#39;. They left out the &#39;R&#39;.
The word was supposed to be CELEBRATE!&quot;

---
An engineer dies and reports to the pearly gates. St. Peter checks his dossier and says, &quot;Ah, you&#39;&#39;re an engineer--you&#39;re in the wrong place.&quot; So, the engineer reports to the gates of hell and is let in. Pretty soon, the engineer gets dissatisfied with the level of comfort in hell, and starts designing and building improvements. After awhile, they&#39;ve got air conditioning, flush toilets and escalators, and the engineer is a pretty popular guy. One day, God calls Satan up on the telephone and says with a sneer, &quot;So, how&#39;s it going down there in hell?&quot; Satan replies, &quot;Hey, things are going great. We&#39;ve got air conditioning, flush toilets and escalators, and there&#39;s no telling what this engineer is going to come up with next.&quot; God replies, &quot;What?? You&#39;ve got an engineer? That&#39;s a mistake--he should never have gotten down there; send him up here.&quot; Satan says, &quot;No way.&quot; I like having an engineer on the staff, and I&#39;m keeping him.&quot; God says, &quot;Send him back up here or I&#39;ll sue.&quot; Satan laughs uproariously and answers, &quot;Yeah, right. And just where are YOU going to get a lawyer?&quot;
---
Q: How many programmers does it take to change a lightbulb?

A: NONE!   That&#39;s a hardware problem....

---
An old man goes to the doctor for his yearly physical, his wife tagging along. When the doctor enters the examination room, he tells the old man, &quot;I need a urine sample, a stool sample and a sperm sample.&quot; The old man, being hard of hearing, looks at his wife and yells: &quot;WHAT? What did he say? What&#39;s he want?&quot; His wife yells back, &quot;He needs your underwear.&quot;
---
A guy walks into a bar, orders a beer and says to the bartender,
&quot;Hey, I got this great Polish Joke...&quot; 

The barkeep glares at him and says in a warning tone of voice:
&quot;Before you go telling that joke you better know that I&#39;m Polish, both
bouncers are Polish and so are most of my customers&quot;

&quot;Okay&quot; says the customer,&quot;I&#39;ll tell it very slowly.&quot; 

---
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">jester_ratings_pivot_df</span> <span class="o">=</span> <span class="n">jester_ratings_df</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;userId&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;jokeId&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">&#39;rating&#39;</span><span class="p">)</span>
<span class="n">jester_ratings_pivot_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>jokeId</th>
      <th>5</th>
      <th>7</th>
      <th>8</th>
      <th>13</th>
      <th>15</th>
      <th>16</th>
      <th>17</th>
      <th>18</th>
      <th>19</th>
      <th>20</th>
      <th>...</th>
      <th>141</th>
      <th>142</th>
      <th>143</th>
      <th>144</th>
      <th>145</th>
      <th>146</th>
      <th>147</th>
      <th>148</th>
      <th>149</th>
      <th>150</th>
    </tr>
    <tr>
      <th>userId</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>0.219</td>
      <td>-9.281</td>
      <td>-9.281</td>
      <td>-6.781</td>
      <td>0.875</td>
      <td>-9.656</td>
      <td>-9.031</td>
      <td>-7.469</td>
      <td>-8.719</td>
      <td>-9.156</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-9.688</td>
      <td>9.938</td>
      <td>9.531</td>
      <td>9.938</td>
      <td>0.406</td>
      <td>3.719</td>
      <td>9.656</td>
      <td>-2.688</td>
      <td>-9.562</td>
      <td>-9.125</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-9.844</td>
      <td>-9.844</td>
      <td>-7.219</td>
      <td>-2.031</td>
      <td>-9.938</td>
      <td>-9.969</td>
      <td>-9.875</td>
      <td>-9.812</td>
      <td>-9.781</td>
      <td>-6.844</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-5.812</td>
      <td>-4.500</td>
      <td>-4.906</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6.906</td>
      <td>4.750</td>
      <td>-5.906</td>
      <td>-0.406</td>
      <td>-4.031</td>
      <td>3.875</td>
      <td>6.219</td>
      <td>5.656</td>
      <td>6.094</td>
      <td>5.406</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 140 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">kmeans</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">jester_ratings_pivot_df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>KMeans(n_clusters=100)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">user_clusters</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">kmeans</span><span class="o">.</span><span class="n">labels_</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">jester_ratings_pivot_df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">user_clusters</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>userId
1        18
2        42
3        64
4        37
5        15
         ..
63974    68
63975    56
63976    98
63977    85
63978    14
Length: 59132, dtype: int32
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">user_cluster_counts</span> <span class="o">=</span> <span class="n">user_clusters</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="n">user_cluster_counts</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>35    3806
98    2301
81    1884
37    1672
78    1655
      ... 
26      47
4       45
31       1
62       1
97       1
Length: 100, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">users_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">user_clusters</span><span class="p">[</span><span class="n">user_clusters</span><span class="o">==</span><span class="n">user_cluster_counts</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">users_set</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{8193, 16389, 7, 24583, 57354, 16395, 32779, 57356, 24592, 57363, 32791, 24601, 16414, 24606, 32801, 49185, 8232, 16425, 24618, 43, 24619, 24621, 49193, 41012, 24631, 58, 24634, 8252, 24638, 24642, 16453, 24647, 49223, 8265, 57421, 49230, 49233, 82, 24659, 24660, 49235, 24663, 24664, 57431, 24666, 32861, 41057, 24678, 57448, 32873, 24683, 116, 16501, 41080, 24700, 125, 16510, 32894, 32895, 8321, 24705, 32898, 8324, 8328, 24714, 16523, 49294, 49295, 24720, 41104, 49297, 49300, 32917, 41109, 57496, 8347, 32923, 41115, 32926, 49309, 8352, 49312, 24746, 32938, 24749, 24750, 32945, 8370, 24756, 49335, 57527, 41149, 57537, 41156, 24778, 24780, 41168, 8406, 49367, 41176, 57559, 49371, 41188, 41189, 57572, 41194, 33007, 24823, 24825, 41211, 49408, 33029, 262, 49416, 33034, 41227, 57613, 16656, 57619, 16660, 16661, 8470, 33045, 24856, 33049, 49428, 283, 49434, 57629, 24865, 8482, 41251, 16676, 49448, 24877, 41264, 8499, 16691, 311, 49467, 16701, 24895, 8515, 324, 49475, 41288, 8524, 41296, 49488, 33110, 49503, 24935, 41320, 24937, 57704, 8555, 364, 24939, 24941, 24943, 57714, 33142, 24951, 24954, 49530, 382, 57729, 24963, 16773, 16777, 41354, 57745, 57747, 8601, 24986, 33178, 33190, 16807, 57766, 427, 33201, 16818, 8628, 33206, 25017, 41401, 57790, 8640, 49601, 8645, 33221, 49606, 41417, 465, 8657, 16849, 49619, 41431, 16856, 33242, 49627, 479, 41443, 57827, 16870, 33258, 16878, 8689, 41458, 8691, 16884, 8693, 49651, 57847, 49659, 33278, 33281, 8708, 25093, 33284, 41478, 49671, 25097, 49672, 57861, 49677, 16910, 8719, 25103, 33294, 33295, 25107, 8724, 16916, 41491, 25111, 41494, 537, 540, 25117, 41500, 57889, 57892, 57893, 556, 25132, 8761, 41529, 25148, 33341, 25154, 582, 25158, 41544, 33354, 41549, 16976, 33361, 594, 8787, 8788, 33364, 49749, 8796, 41565, 25182, 16992, 16996, 615, 8809, 8813, 25198, 33390, 41584, 626, 632, 633, 49787, 25223, 41610, 41611, 49803, 17038, 656, 25236, 661, 49814, 33439, 17057, 675, 17062, 681, 688, 8881, 17075, 25275, 49852, 17089, 8900, 33477, 711, 712, 8905, 33481, 17099, 33482, 25294, 17103, 17104, 17105, 58065, 17107, 25305, 17114, 49882, 58073, 33503, 17121, 58084, 33509, 25320, 746, 8941, 41712, 25330, 8950, 58103, 761, 25340, 25341, 25342, 33536, 41729, 41731, 41732, 49923, 25350, 49926, 49928, 33548, 49934, 17168, 8980, 789, 17179, 25372, 8989, 17182, 25374, 25376, 41760, 41762, 41763, 49950, 805, 33574, 17192, 41782, 17210, 17212, 58174, 58175, 9028, 17220, 17222, 17223, 841, 9033, 25417, 41804, 25422, 50000, 33617, 17234, 33620, 17239, 50009, 17242, 41819, 33629, 9054, 50014, 41824, 17251, 33639, 17256, 9065, 9066, 58215, 41840, 25458, 888, 25464, 890, 891, 25466, 33656, 58238, 25472, 25473, 33664, 33667, 25478, 25479, 41863, 58249, 9098, 9099, 25483, 33674, 9103, 41875, 25493, 41877, 9112, 17305, 25502, 17311, 17312, 25503, 25504, 25505, 33696, 41893, 58273, 25512, 50090, 943, 17327, 17329, 25519, 25523, 17332, 25527, 17345, 17346, 17347, 41925, 33734, 33735, 58315, 9164, 17362, 17363, 58325, 41942, 17367, 41945, 41946, 25567, 25568, 9185, 50143, 17379, 25571, 50145, 41967, 33776, 33781, 17398, 17399, 9208, 9209, 58360, 25595, 33787, 17405, 25599, 58367, 9218, 41986, 41987, 17415, 33799, 17419, 1037, 9229, 25615, 17424, 25617, 42000, 25623, 1048, 25625, 33815, 42007, 1054, 42014, 33827, 17448, 42029, 25648, 33840, 58418, 17460, 33846, 17466, 9276, 25660, 9287, 25674, 1102, 17486, 17487, 50256, 50260, 1109, 33880, 17497, 25690, 17499, 50268, 9309, 1119, 33888, 50272, 58467, 33896, 9322, 50282, 42093, 42094, 33903, 25712, 50288, 58479, 50291, 58482, 9336, 50297, 42106, 42113, 50305, 9348, 17541, 25737, 9354, 58508, 9360, 25744, 42130, 25747, 17556, 25755, 25761, 17573, 33958, 42153, 25770, 25772, 17581, 25773, 17583, 25776, 33969, 25778, 17587, 33971, 25783, 17592, 42173, 17598, 58564, 17607, 9416, 50379, 34005, 34007, 42200, 58587, 58592, 25825, 42215, 58599, 42217, 58600, 42219, 58602, 1261, 9454, 42221, 34032, 50417, 34036, 42230, 42231, 34042, 9467, 50426, 17663, 17666, 58627, 42246, 34056, 9481, 34058, 17675, 42250, 50441, 58633, 42255, 34065, 50452, 34069, 25878, 50455, 17689, 25881, 50457, 50458, 34081, 9506, 9507, 25894, 9512, 58664, 25898, 1328, 25904, 9526, 50487, 34108, 25921, 9540, 50500, 58698, 25931, 42319, 25937, 9555, 1364, 25939, 17750, 42323, 50518, 9564, 25949, 17759, 25951, 50527, 34146, 34147, 50531, 58723, 17768, 50536, 17771, 42349, 17774, 17776, 1394, 17779, 50550, 25975, 58746, 17787, 42364, 17789, 42369, 17798, 50570, 1421, 1422, 1423, 9615, 25997, 42386, 1431, 17816, 34204, 50589, 34207, 26018, 1443, 17827, 34212, 58786, 58789, 26025, 9646, 42415, 26042, 34234, 9660, 34236, 42426, 26047, 26053, 42439, 17864, 17865, 1482, 26062, 17872, 34256, 42450, 26070, 42456, 58846, 17887, 17888, 26079, 34272, 9699, 26083, 42466, 42472, 58857, 34282, 58858, 26092, 26093, 58862, 26097, 17908, 26100, 26102, 58874, 26110, 34305, 26116, 9733, 50694, 58886, 17928, 26121, 34315, 17932, 17933, 58898, 26132, 17941, 26134, 34326, 50708, 50709, 9755, 58910, 26144, 17953, 58918, 50727, 17960, 58927, 34361, 34363, 50750, 17983, 50752, 9795, 58950, 50762, 17995, 1613, 1617, 26193, 26194, 58968, 26202, 18012, 18013, 58976, 26210, 18024, 42603, 9836, 34412, 26222, 42604, 58991, 34417, 42610, 1651, 18035, 26231, 1657, 42624, 42625, 18050, 26242, 26247, 1677, 26253, 42640, 26257, 59027, 42645, 26262, 34455, 9880, 18073, 26266, 59032, 1693, 18082, 34467, 50853, 59045, 26279, 18088, 50855, 42666, 59050, 34478, 18097, 18099, 50873, 50876, 9918, 50880, 18115, 26308, 59077, 42695, 9928, 34504, 59081, 34508, 26317, 34509, 26319, 26323, 34516, 26325, 50902, 18137, 18138, 26332, 59100, 18144, 59104, 9954, 9958, 9961, 9962, 59115, 34540, 50925, 18158, 26351, 18161, 57341, 18167, 59131, 50940, 1789, 18175, 18176, 26368, 26369, 34562, 50943, 50944, 42762, 34571, 26380, 26381, 50958, 1809, 1810, 18195, 26389, 50965, 10008, 18201, 59161, 26396, 10014, 34591, 18208, 42785, 50974, 10022, 34602, 26411, 10028, 59186, 18229, 26421, 1849, 18234, 18235, 34621, 51008, 10050, 10053, 34630, 42823, 34634, 42830, 26447, 18256, 26449, 1880, 26457, 34648, 26464, 18278, 26471, 42857, 34666, 18283, 51051, 51052, 51054, 18289, 18290, 26485, 10102, 26486, 51061, 18297, 1914, 26491, 18300, 10109, 42875, 18303, 26495, 26497, 51073, 18313, 18315, 34699, 51083, 10128, 34704, 59282, 59284, 51093, 34714, 51106, 18341, 18346, 10155, 34730, 51118, 18356, 34741, 51127, 34744, 42937, 51129, 26555, 34747, 18367, 10178, 42947, 34757, 26566, 26567, 18380, 51151, 42964, 10199, 10202, 26587, 42971, 26591, 34785, 42977, 10215, 10217, 26601, 34798, 26609, 2035, 18420, 10229, 18423, 26616, 26617, 34809, 43003, 10237, 51199, 26625, 43011, 59402, 43021, 51214, 18448, 18449, 59414, 18455, 26647, 10267, 10269, 10271, 26656, 10275, 59427, 43045, 18472, 59432, 34862, 10288, 2098, 2099, 59442, 34869, 10294, 34870, 2104, 59443, 10300, 26684, 34878, 51266, 43076, 2117, 51269, 59464, 43081, 51274, 43086, 18511, 43091, 18516, 2133, 2134, 26710, 34903, 59485, 26720, 34913, 26723, 51300, 59491, 2150, 26726, 26728, 43115, 10348, 2159, 59507, 43125, 34936, 18553, 18555, 18556, 34939, 34940, 51326, 18561, 26754, 59522, 2183, 51341, 43150, 2193, 43155, 51351, 10394, 34975, 18592, 34977, 26786, 51362, 10405, 18598, 43176, 10414, 2224, 10425, 26811, 10428, 26820, 2249, 18640, 35029, 18647, 10456, 26841, 59613, 35044, 18661, 10470, 10475, 18671, 26865, 35058, 51441, 26868, 2296, 35066, 43260, 10496, 18689, 35072, 10499, 43265, 35077, 51457, 18695, 26888, 18697, 35079, 59650, 43276, 59661, 43278, 35088, 51472, 35090, 51473, 18708, 18709, 18710, 43285, 51474, 51481, 35099, 35100, 26909, 26912, 59687, 35112, 43307, 18733, 26926, 18735, 26927, 26929, 35122, 43315, 51504, 26933, 18742, 18743, 26935, 51508, 51513, 59704, 26940, 59706, 59710, 59712, 26946, 26950, 59719, 26953, 2378, 26958, 10578, 59732, 35165, 18782, 59742, 10593, 35171, 35172, 51557, 26984, 10610, 2421, 10614, 43386, 27005, 27006, 51587, 18821, 43399, 27016, 18825, 51591, 2445, 27022, 43406, 35216, 51601, 18834, 27027, 10645, 35223, 51607, 2457, 59799, 2459, 51614, 27043, 10664, 43435, 51627, 27053, 59821, 18866, 27058, 51635, 18869, 10678, 59830, 27065, 18881, 43458, 59842, 35271, 18890, 59851, 18893, 27085, 43470, 27088, 18897, 27089, 43478, 51670, 18904, 51672, 10715, 27101, 51679, 10720, 51681, 51683, 10724, 10725, 27110, 51687, 27116, 27118, 35311, 27120, 51697, 2547, 18931, 18933, 35317, 10747, 27133, 27134, 18943, 27135, 59906, 35331, 43525, 10759, 18955, 59922, 51737, 43546, 43547, 27165, 18974, 35358, 27168, 43553, 18978, 51742, 51748, 59943, 59946, 27180, 18996, 51765, 59957, 27193, 27195, 51771, 27197, 51773, 59965, 27200, 10822, 19015, 35407, 43602, 10835, 35411, 19029, 51799, 59996, 43621, 27238, 19047, 19049, 35434, 43626, 60011, 51821, 35438, 10863, 19055, 19057, 51825, 60016, 35447, 51832, 60023, 43654, 43655, 35467, 27276, 10895, 27280, 43663, 60048, 10899, 60053, 2710, 10910, 43681, 2723, 10919, 10922, 19115, 43694, 43700, 19125, 27318, 60088, 19129, 43705, 51898, 2752, 27328, 10949, 51910, 60103, 10961, 43730, 35539, 43733, 27351, 27352, 35546, 60123, 2780, 51934, 51938, 2788, 43748, 27367, 27368, 10986, 2795, 10988, 27371, 27375, 10994, 27378, 35574, 51958, 19192, 27384, 43770, 2812, 60157, 11006, 35584, 35587, 2821, 51973, 35591, 27400, 19209, 27402, 60176, 35602, 60181, 35607, 35613, 51998, 27429, 60199, 52008, 2859, 27435, 52011, 43822, 52013, 60206, 27442, 52018, 60213, 27447, 27448, 52024, 2874, 43836, 27453, 27457, 52035, 19270, 19275, 19276, 27468, 35659, 43853, 19280, 27473, 52053, 60245, 52055, 2906, 52059, 27484, 27487, 2913, 27489, 11111, 60264, 19309, 43885, 27508, 19317, 11126, 52087, 11134, 43905, 19330, 19331, 11142, 35721, 60299, 11148, 60300, 60305, 43926, 11159, 43928, 19354, 27547, 35738, 35741, 52122, 52126, 52128, 43938, 27555, 52134, 60327, 11178, 52140, 27572, 52151, 19384, 27578, 27580, 11197, 11200, 27588, 35782, 3016, 27592, 27594, 60361, 11214, 27598, 27599, 11219, 43990, 3031, 60375, 27609, 60379, 27612, 11229, 11230, 27613, 52194, 11235, 3044, 27621, 44003, 52195, 3051, 35819, 11247, 44017, 11250, 44019, 19452, 60418, 3086, 3087, 27663, 19473, 44046, 60433, 60435, 19477, 27669, 11288, 35864, 35866, 27675, 44056, 44057, 3102, 35870, 44061, 35873, 44064, 27683, 52258, 27687, 19498, 3116, 60460, 60461, 60463, 11313, 44084, 11319, 44087, 60473, 19514, 60478, 11327, 60479, 35907, 52291, 27717, 35910, 35914, 27723, 60490, 27726, 11343, 11344, 44112, 52305, 3162, 44126, 44128, 44129, 3173, 44142, 35951, 27760, 3185, 52344, 27772, 19581, 60543, 35969, 27780, 44164, 3207, 11401, 11402, 3211, 11405, 35982, 27793, 60561, 60570, 11419, 44193, 36002, 19622, 19623, 19624, 44200, 44203, 44205, 3247, 27832, 3259, 19643, 19660, 36046, 36048, 19665, 44243, 44247, 44259, 27876, 11493, 19685, 36070, 27881, 60649, 27887, 11504, 3316, 27894, 60667, 3327, 60671, 52481, 19716, 27908, 44293, 27913, 27918, 19733, 27926, 36117, 11544, 27928, 11555, 52515, 11557, 11562, 36140, 44334, 27952, 19761, 27954, 60726, 11576, 36154, 44346, 44347, 52540, 44353, 3394, 36164, 19782, 27974, 36168, 19785, 44361, 44363, 52551, 27981, 36174, 60744, 44371, 44376, 11609, 44380, 36189, 11616, 11617, 60768, 28007, 11630, 44404, 60789, 28023, 19834, 60795, 52604, 19838, 11647, 28033, 28035, 52612, 28037, 36229, 36234, 36236, 52620, 19855, 3472, 28047, 28050, 3475, 28051, 36240, 28054, 36245, 28056, 52629, 36250, 52630, 60826, 11679, 28063, 11681, 19875, 44452, 52644, 44455, 19881, 36267, 28077, 11694, 28079, 11696, 11697, 44465, 52656, 3508, 11700, 44472, 60861, 19913, 36299, 44493, 60878, 28111, 36303, 36304, 44495, 44496, 52688, 28117, 60886, 44504, 44505, 19931, 3548, 28125, 11742, 36317, 11747, 44517, 36329, 28140, 28142, 3567, 28144, 44529, 11762, 28147, 28148, 44533, 11766, 28151, 52719, 11770, 52730, 44541, 3585, 44545, 44546, 60930, 11783, 36360, 28177, 44561, 60946, 11797, 3606, 28183, 36373, 11801, 28186, 36377, 44571, 36384, 36385, 60963, 11813, 28197, 11817, 20012, 36396, 44588, 28207, 52781, 3635, 36404, 36405, 44597, 44599, 60980, 3641, 28219, 36412, 28224, 52803, 28228, 20038, 36424, 44616, 52809, 61001, 28236, 20045, 36429, 20051, 28244, 44628, 52822, 36440, 44633, 36445, 11871, 28255, 20065, 36452, 11881, 11883, 28274, 61043, 11893, 44662, 52855, 44666, 61053, 3710, 20095, 52863, 52864, 20103, 44679, 61066, 61069, 20111, 3736, 28313, 28315, 11935, 61089, 44706, 11942, 3756, 28335, 20144, 52913, 11954, 3765, 20155, 52923, 44734, 3775, 20160, 20161, 44738, 61120, 28357, 28358, 28359, 36550, 11977, 52936, 36555, 20172, 20173, 28364, 44754, 11987, 20181, 20182, 20183, 3799, 11991, 28375, 20187, 36569, 36570, 61143, 36576, 36577, 44772, 28389, 20199, 61161, 28394, 3823, 20207, 12017, 36591, 12019, 28403, 44783, 44788, 12023, 12025, 12027, 3836, 20220, 36604, 28415, 44800, 61182, 52999, 44808, 44810, 20235, 12044, 20237, 53002, 20239, 12050, 53012, 3866, 36638, 3872, 44834, 28453, 36649, 53037, 53038, 61233, 20275, 28468, 20278, 44855, 3897, 44857, 12100, 3909, 20294, 36676, 53062, 28490, 36683, 3916, 20303, 36689, 61266, 61270, 3934, 28515, 12134, 53100, 61294, 3954, 36723, 28532, 61303, 36728, 20350, 20352, 12161, 28544, 36738, 44932, 61317, 3983, 28561, 12178, 3988, 28565, 36758, 53140, 12186, 28571, 53148, 53153, 36770, 28582, 44967, 44968, 20393, 61354, 53163, 28589, 61357, 12210, 28600, 61369, 20412, 4029, 12221, 28604, 12224, 36802, 61379, 53188, 61380, 20425, 28620, 28624, 12241, 20434, 53205, 61397, 12249, 20446, 20447, 45023, 36834, 20452, 45029, 20458, 53232, 20468, 36852, 61428, 28664, 36857, 20474, 45048, 61433, 28669, 36862, 45055, 4098, 61442, 61443, 4104, 4105, 45065, 20494, 20495, 61454, 45077, 12312, 36889, 20507, 45085, 4126, 36897, 45094, 12332, 53299, 20532, 53302, 12343, 45112, 53305, 36923, 45117, 20544, 4163, 28742, 45128, 4170, 20555, 28746, 45133, 61519, 45145, 4197, 28774, 12391, 12402, 28787, 53365, 36982, 61561, 4221, 12415, 20608, 12420, 20616, 28808, 37002, 45193, 37004, 45195, 53384, 20623, 28817, 4250, 12442, 61594, 4260, 45222, 12456, 45224, 37035, 12461, 37037, 53421, 45232, 53427, 4276, 45240, 20668, 4285, 53437, 12480, 4289, 28864, 45250, 45253, 28872, 37065, 45257, 4301, 28878, 28879, 37070, 28881, 53459, 37076, 28889, 53466, 45275, 61660, 28893, 20702, 4322, 12514, 53476, 53478, 53480, 37098, 53482, 53486, 37104, 20721, 37105, 4339, 12532, 28915, 45301, 4343, 4344, 53489, 53499, 61691, 4350, 61697, 45314, 45316, 61702, 12557, 37133, 12561, 28945, 45329, 45330, 28951, 53528, 20763, 45342, 12576, 28963, 61734, 28968, 53546, 12588, 61743, 28976, 53556, 53557, 45368, 61755, 45377, 20802, 45378, 4422, 61767, 45385, 61773, 61779, 20820, 37204, 4439, 29015, 29016, 53591, 45404, 57871, 20836, 45414, 61798, 53608, 61802, 37228, 4461, 45421, 61804, 61808, 45425, 45426, 45429, 61819, 20860, 61821, 20863, 45439, 61823, 12674, 53635, 45450, 20876, 29068, 53644, 45456, 53650, 61842, 12695, 53656, 12697, 61847, 20891, 61849, 20893, 53661, 12705, 29090, 45480, 12713, 12714, 61864, 53676, 4525, 29102, 37294, 45485, 29111, 4537, 45501, 29118, 61885, 45505, 45509, 37320, 29135, 37329, 53713, 20947, 29142, 12762, 37348, 20969, 37355, 53739, 37360, 4594, 12790, 20983, 12811, 4626, 61974, 61976, 53786, 4639, 12832, 29216, 37410, 4643, 37411, 45599, 53794, 37420, 12845, 61999, 37424, 4657, 37426, 53811, 21044, 45620, 21046, 12855, 21048, 45621, 29242, 12859, 62015, 29248, 21057, 12866, 53824, 29259, 4688, 12881, 29266, 29267, 29270, 53847, 21080, 4698, 62043, 21087, 4705, 21090, 37474, 53860, 62052, 62053, 4713, 37485, 37486, 4719, 37488, 29300, 62073, 45693, 62077, 21128, 12937, 53900, 53903, 37521, 4754, 37522, 29333, 12953, 12954, 62105, 4764, 29340, 62110, 45727, 29347, 21156, 37545, 45741, 45749, 53941, 4791, 29370, 62140, 45761, 21187, 4804, 37571, 37578, 45770, 21196, 21202, 37592, 62168, 45788, 21213, 37601, 62177, 13028, 21220, 37608, 62185, 21229, 37618, 54002, 62195, 29434, 13052, 4862, 4867, 54022, 62221, 29454, 45840, 21265, 45842, 45843, 21271, 37656, 37658, 21277, 29469, 21279, 37661, 29473, 62237, 62245, 45862, 13096, 29483, 29486, 21297, 21302, 4920, 29496, 13114, 29497, 21308, 54074, 21310, 62271, 29507, 37703, 54090, 13131, 62282, 21326, 21331, 21332, 45907, 4950, 54103, 54107, 62300, 37725, 4958, 13150, 45919, 21352, 62314, 21357, 62324, 29557, 37755, 62334, 45951, 4992, 21376, 45952, 21379, 21382, 62346, 62347, 13200, 37777, 21394, 13203, 62358, 54167, 54168, 21404, 37789, 29598, 45981, 62364, 37793, 21413, 13223, 37800, 5034, 13228, 45996, 29614, 21428, 29620, 13240, 29629, 5055, 21440, 13250, 21442, 21446, 54219, 29644, 46030, 62418, 62422, 13271, 29656, 13273, 21465, 13275, 37852, 5092, 29670, 62440, 21481, 21482, 21483, 54250, 21486, 21488, 13298, 54261, 13307, 21499, 46075, 5119, 13312, 54275, 46084, 37893, 46085, 21511, 21514, 46098, 37908, 46101, 21528, 21529, 21530, 46108, 62493, 62496, 13345, 37921, 21542, 62507, 29740, 29742, 5167, 21552, 13368, 21565, 13374, 21566, 13376, 29758, 46142, 46144, 21573, 5191, 13383, 29770, 37964, 21581, 5199, 54353, 29780, 62550, 29785, 62555, 54367, 21600, 54377, 21611, 13423, 21615, 38002, 62578, 21621, 46202, 29821, 54398, 21635, 21636, 21637, 5254, 62596, 62598, 38026, 13451, 62606, 29839, 21649, 54418, 46227, 62609, 54422, 21657, 21658, 5275, 21664, 46241, 62625, 54436, 62629, 54438, 62630, 29864, 38058, 21675, 13484, 21677, 29870, 13488, 38067, 62643, 29877, 21686, 29881, 62654, 62659, 13513, 13514, 29899, 29901, 56418, 62672, 5330, 54482, 46292, 13528, 13532, 13533, 13534, 38111, 54492, 29923, 46307, 54505, 21741, 46319, 13554, 29941, 54517, 5369, 62714, 38140, 62717, 29951, 46338, 62723, 21765, 21767, 38152, 38153, 21770, 21773, 21774, 29969, 21778, 13588, 21784, 29977, 46361, 5403, 21790, 21792, 21797, 46373, 21799, 62757, 5417, 62758, 62759, 62763, 21805, 21806, 54574, 21809, 21811, 21812, 46390, 21815, 38200, 30009, 46392, 46396, 21821, 62780, 46400, 21827, 38211, 21829, 38214, 5447, 13641, 62793, 62794, 62798, 5459, 38227, 21846, 21847, 21848, 30038, 38240, 21857, 30049, 5486, 5492, 13686, 62841, 38266, 46461, 30078, 21888, 30081, 13698, 30086, 38279, 13704, 21900, 54668, 21904, 13714, 13718, 13721, 30106, 38301, 46494, 54687, 62882, 21925, 5542, 62887, 5546, 54700, 38322, 21940, 62902, 46525, 21953, 38344, 46538, 38348, 30158, 54735, 21969, 38355, 5589, 46549, 46557, 5598, 21982, 54749, 62947, 21988, 21989, 13799, 30186, 38379, 22000, 13809, 62962, 22007, 54775, 62970, 62974, 22017, 62980, 30214, 30215, 13832, 30218, 30227, 38424, 5658, 22042, 22043, 30237, 22047, 30240, 13858, 13863, 54823, 46636, 54829, 22064, 13873, 38449, 30259, 46641, 54832, 30262, 38455, 54837, 54844, 54850, 30276, 30279, 13898, 63053, 46670, 63059, 5717, 22101, 46679, 46687, 13924, 54884, 38508, 22127, 22129, 22132, 30324, 22134, 54901, 13947, 13951, 38529, 54917, 30342, 30343, 54920, 38539, 22156, 5773, 30351, 38544, 5777, 5783, 22172, 5789, 5790, 22173, 5792, 30367, 22178, 54943, 63140, 22182, 30374, 22184, 30376, 46766, 22192, 30384, 5811, 5814, 22199, 14009, 22201, 30394, 46778, 30407, 5834, 63181, 54990, 22228, 22230, 63192, 5849, 46810, 14043, 5852, 5853, 14047, 5856, 5858, 46818, 38634, 46827, 14060, 46828, 46830, 5871, 55018, 22258, 30450, 46840, 14074, 46848, 22273, 30469, 63240, 14090, 46861, 38670, 5903, 22288, 38673, 38676, 22293, 38679, 46871, 14109, 22301, 22305, 38689, 63268, 30502, 30503, 22312, 38696, 38698, 63275, 5932, 30508, 55089, 22325, 55093, 38711, 46904, 63290, 38716, 30529, 30535, 38729, 55117, 30542, 5968, 14161, 38736, 22355, 38740, 55124, 5976, 38744, 22362, 55129, 5981, 46945, 46946, 30565, 30566, 55143, 30572, 5997, 30574, 38767, 6000, 46958, 30578, 63349, 30583, 30586, 6013, 14207, 46976, 55170, 22404, 30597, 55174, 22408, 22410, 14220, 6029, 22412, 22414, 63376, 6041, 63387, 6046, 30626, 6051, 30627, 38819, 47012, 55205, 30632, 55206, 6058, 14250, 22443, 30637, 38829, 47021, 47023, 47025, 55210, 63405, 30645, 55222, 22455, 63417, 47037, 38846, 6079, 22468, 6085, 30661, 22473, 6091, 30669, 63438, 30671, 6096, 22480, 55251, 6100, 30676, 63445, 6103, 22496, 22497, 47073, 30693, 30697, 55276, 55279, 63472, 30714, 47099, 22524, 14333, 6147, 63491, 6151, 14349, 55311, 22544, 22548, 14358, 30743, 6171, 22556, 6173, 14366, 14367, 47136, 47137, 55326, 63515, 22564, 47141, 6182, 22567, 55336, 6185, 63522, 14384, 47153, 63542, 22585, 14395, 63547, 14399, 22591, 47168, 14408, 38988, 55373, 6222, 63566, 63567, 63569, 22615, 47192, 47199, 14432, 22624, 39009, 39010, 39012, 55394, 39014, 6247, 30825, 6251, 22636, 6254, 39026, 6259, 63602, 63604, 6264, 47225, 14458, 14460, 6270, 39040, 39045, 47241, 22666, 55437, 47246, 6287, 22673, 30868, 47253, 47259, 6303, 47264, 22689, 22690, 39078, 14503, 30889, 6314, 63659, 22702, 55471, 63662, 63665, 6330, 47295, 6336, 63682, 6342, 22727, 22729, 63689, 30925, 14542, 14544, 22736, 6354, 30935, 30938, 22748, 6365, 22751, 6369, 14566, 22761, 30954, 30962, 63730, 30966, 30967, 6392, 63734, 55553, 6402, 63747, 39173, 22792, 22795, 14604, 22796, 14606, 47374, 30993, 63762, 6421, 22806, 30998, 31001, 14619, 6438, 22822, 22824, 22825, 31017, 47402, 6447, 14646, 47415, 22842, 6461, 31037, 6463, 63806, 63807, 6471, 31047, 22858, 22859, 39242, 22861, 39243, 14671, 63819, 47446, 14680, 31072, 22881, 14691, 39268, 14693, 55652, 55656, 39278, 22895, 22901, 14711, 39289, 14714, 22907, 22908, 39292, 22914, 31106, 6540, 22927, 47503, 22935, 55704, 63896, 22939, 22942, 6561, 22948, 22949, 22950, 22951, 63910, 63916, 14766, 14772, 22967, 55736, 39353, 22971, 6588, 6589, 22973, 6591, 22976, 22977, 47547, 63934, 63936, 6598, 47558, 6600, 22984, 39370, 14795, 47559, 55761, 6612, 22996, 6614, 63962, 23003, 23005, 55773, 63971, 14821, 23017, 39402, 23019, 23022, 23024, 23026, 47607, 23033, 31226, 23037, 31233, 31234, 6663, 23048, 39432, 6667, 55821, 31252, 39447, 23071, 23072, 6689, 47649, 31269, 31274, 6699, 39466, 47671, 31288, 47673, 39483, 6724, 14917, 55882, 31307, 39501, 23121, 39505, 14932, 23125, 39510, 23127, 23128, 55892, 39517, 23135, 47714, 23139, 47724, 31341, 23150, 39533, 55923, 31351, 47735, 31354, 39547, 14974, 6784, 31361, 47744, 14979, 6788, 31363, 31364, 31366, 39558, 39562, 6800, 55952, 14997, 14998, 31383, 39574, 47765, 31391, 39585, 47778, 23208, 23212, 55986, 39606, 31416, 47801, 47804, 31422, 31423, 31425, 23237, 47813, 47815, 31432, 39624, 31435, 6862, 47822, 39634, 6871, 15066, 56027, 56028, 56029, 39650, 47843, 39653, 31467, 47851, 39663, 56047, 47857, 6901, 47862, 31483, 6908, 56060, 31489, 31495, 47881, 15126, 31517, 56093, 31520, 23329, 31521, 39721, 6954, 56107, 31534, 15152, 56115, 23348, 56117, 23350, 39737, 23355, 56124, 31553, 6979, 6984, 6991, 15183, 31569, 56143, 6998, 47959, 15194, 39771, 31580, 47966, 39779, 31590, 39783, 47975, 31593, 39795, 47988, 23413, 56180, 7032, 7033, 39809, 48009, 15242, 23435, 39821, 39823, 23440, 23441, 39826, 23443, 56213, 56217, 56218, 48031, 7074, 31651, 39845, 56231, 23467, 48043, 39853, 15280, 31664, 31666, 15283, 39856, 31669, 56247, 23481, 39866, 31679, 15297, 7107, 15300, 7111, 23496, 31690, 31693, 48077, 23509, 48085, 7131, 23520, 23521, 31712, 7139, 23524, 39906, 48100, 23528, 15337, 48107, 31726, 39923, 48118, 39929, 23548, 31740, 23550, 23555, 7173, 56327, 23561, 31755, 39947, 7181, 31757, 39960, 15386, 7198, 39967, 48160, 7203, 23589, 7206, 23591, 39974, 48168, 23594, 23595, 56363, 39989, 56376, 23612, 23616, 40000, 40001, 48194, 48197, 56389, 23624, 56392, 56396, 23631, 31824, 23633, 48209, 48211, 56401, 7255, 7257, 23641, 23642, 31836, 48217, 48219, 23647, 56413, 48225, 48226, 31843, 48228, 56415, 31846, 31847, 40039, 40041, 15466, 31851, 48231, 48236, 48238, 56429, 31856, 23669, 23670, 31867, 23677, 7296, 56449, 56451, 15494, 48263, 23689, 7308, 31884, 7313, 40082, 31893, 23703, 23707, 15521, 40097, 56485, 15526, 15527, 15531, 48299, 56491, 56492, 56494, 40113, 31922, 56505, 31935, 48319, 7362, 7365, 23755, 15565, 23759, 48335, 23762, 23763, 31958, 31959, 48344, 40153, 31966, 15589, 56549, 23783, 31976, 48361, 40171, 40173, 15600, 23795, 56563, 15605, 7415, 31991, 48380, 32002, 56580, 40202, 23821, 7442, 15634, 23829, 48408, 7449, 23833, 23839, 40224, 56610, 23848, 40237, 48432, 40243, 23865, 15679, 56639, 40258, 7491, 56642, 32070, 23880, 32073, 40265, 32076, 32078, 32079, 32080, 40271, 56656, 48468, 15703, 7512, 32087, 23901, 40287, 40291, 23912, 32104, 40296, 7532, 23917, 48492, 48499, 40321, 48518, 40329, 23946, 23947, 23951, 15764, 23957, 23958, 23960, 48536, 40348, 40354, 56738, 7588, 40358, 56742, 48554, 7595, 56750, 32177, 48571, 23998, 24003, 40390, 24013, 32206, 7635, 40404, 24022, 40410, 48605, 56799, 32225, 48614, 56814, 48634, 15868, 15869, 56829, 40448, 63399, 24066, 32258, 40452, 40453, 56835, 7688, 40457, 32266, 24079, 48660, 7703, 48665, 15901, 7713, 24100, 7717, 24102, 24103, 24104, 40485, 15914, 7727, 24112, 40496, 32306, 15927, 32311, 40503, 40508, 48700, 32319, 56895, 32325, 56901, 40521, 32334, 7759, 15951, 32335, 40528, 48725, 56918, 7769, 7770, 24153, 24160, 40544, 32354, 40545, 48738, 32365, 32369, 40562, 7795, 56947, 15990, 24183, 56952, 7801, 7802, 56962, 24196, 48773, 24202, 16011, 16013, 24207, 7824, 7825, 24210, 32405, 16022, 40598, 48791, 24219, 16033, 24228, 16037, 40613, 24231, 56998, 32425, 56999, 57001, 7864, 48824, 57022, 24259, 24260, 32453, 57027, 40656, 32465, 48853, 16088, 16089, 40665, 16095, 24287, 48865, 7912, 24297, 40681, 48875, 57066, 48877, 24302, 40691, 48883, 7925, 48886, 24314, 40700, 40704, 32517, 24326, 40710, 40711, 16137, 40712, 57099, 24334, 40719, 57102, 40728, 48921, 24347, 16157, 40733, 48925, 7972, 24358, 7976, 7977, 24362, 7979, 48939, 16174, 32562, 7987, 40755, 48948, 32567, 57144, 32571, 24380, 40763, 40767, 24384, 40769, 48963, 48967, 24398, 32596, 48980, 57174, 57175, 32610, 48994, 40806, 24426, 32618, 24428, 32622, 32623, 40817, 40820, 49013, 49017, 24443, 8060, 40830, 40831, 24450, 40834, 49032, 24457, 8074, 49033, 57229, 49040, 8081, 49045, 32663, 40859, 57244, 32672, 24484, 49065, 8106, 16299, 24493, 40877, 49075, 49078, 8119, 40888, 57271, 8122, 24508, 32700, 49086, 8132, 24516, 24519, 8136, 32713, 49100, 49102, 49104, 8146, 32723, 24533, 8151, 24536, 8154, 32738, 16355, 49123, 32743, 40936, 49127, 49130, 40939, 32752, 57329, 24562, 40947, 40954, 49147, 40957}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">jester_group_sorted</span> <span class="o">=</span> <span class="n">jester_ratings_df</span><span class="p">[</span><span class="n">jester_ratings_df</span><span class="o">.</span><span class="n">userId</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">users_set</span><span class="p">)]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;jokeId&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rating</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">jester_jokes_df</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;rating&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">jester_group_sorted</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>rating</th>
      <th>jokeId</th>
      <th>jokeText</th>
    </tr>
    <tr>
      <th>jokeId</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>53</th>
      <td>1.457240</td>
      <td>54.0</td>
      <td>The Pope dies and, naturally, goes to heaven. ...</td>
    </tr>
    <tr>
      <th>114</th>
      <td>1.289011</td>
      <td>115.0</td>
      <td>A lady bought a new Lexus. It cost a bundle. T...</td>
    </tr>
    <tr>
      <th>50</th>
      <td>1.147600</td>
      <td>51.0</td>
      <td>Did you hear that Clinton has announced there ...</td>
    </tr>
    <tr>
      <th>126</th>
      <td>1.140983</td>
      <td>127.0</td>
      <td>A little boy goes to his dad and asks, "What i...</td>
    </tr>
    <tr>
      <th>89</th>
      <td>1.136812</td>
      <td>90.0</td>
      <td>Q: How many programmers does it take to change...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">users_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">user_clusters</span><span class="p">[</span><span class="n">user_clusters</span><span class="o">==</span><span class="n">user_cluster_counts</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">]]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">jester_group_sorted</span> <span class="o">=</span> <span class="n">jester_ratings_df</span><span class="p">[</span><span class="n">jester_ratings_df</span><span class="o">.</span><span class="n">userId</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">users_set</span><span class="p">)]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;jokeId&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rating</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">jester_jokes_df</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;rating&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">jester_group_sorted</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>rating</th>
      <th>jokeId</th>
      <th>jokeText</th>
    </tr>
    <tr>
      <th>jokeId</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>80</th>
      <td>9.469000</td>
      <td>81.0</td>
      <td>An Asian man goes into a New York CityBank to ...</td>
    </tr>
    <tr>
      <th>73</th>
      <td>8.937500</td>
      <td>74.0</td>
      <td>Q: How many stalkers does it take to change a ...</td>
    </tr>
    <tr>
      <th>116</th>
      <td>7.938000</td>
      <td>117.0</td>
      <td>A man joins a big corporate empire as a traine...</td>
    </tr>
    <tr>
      <th>106</th>
      <td>7.290574</td>
      <td>107.0</td>
      <td>(A) The Japanese eat very little fat and suffe...</td>
    </tr>
    <tr>
      <th>63</th>
      <td>7.135891</td>
      <td>64.0</td>
      <td>What is the rallying cry of the International ...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kmeans</span><span class="o">.</span><span class="n">inertia_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>30322545.978758477
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="n">kmeans</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">jester_ratings_pivot_df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>KMeans(n_clusters=200)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kmeans</span><span class="o">.</span><span class="n">inertia_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>28653640.838373728
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">user_clusters</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">kmeans</span><span class="o">.</span><span class="n">labels_</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">jester_ratings_pivot_df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">user_clusters</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>43     3134
110    2009
7      1161
1      1059
118    1038
       ... 
116       1
115       1
80        1
158       1
125       1
Length: 200, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">users_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">user_clusters</span><span class="p">[</span><span class="n">user_clusters</span><span class="o">==</span><span class="mi">49</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">jester_group_sorted</span> <span class="o">=</span> <span class="n">jester_ratings_df</span><span class="p">[</span><span class="n">jester_ratings_df</span><span class="o">.</span><span class="n">userId</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">users_set</span><span class="p">)]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;jokeId&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rating</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">jester_jokes_df</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;rating&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">jester_group_sorted</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>rating</th>
      <th>jokeId</th>
      <th>jokeText</th>
    </tr>
    <tr>
      <th>jokeId</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>27</th>
      <td>4.927000</td>
      <td>28.0</td>
      <td>A mechanical, electrical and a software engine...</td>
    </tr>
    <tr>
      <th>116</th>
      <td>4.562000</td>
      <td>117.0</td>
      <td>A man joins a big corporate empire as a traine...</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1.609726</td>
      <td>9.0</td>
      <td>A country guy goes into a city bar that has a ...</td>
    </tr>
    <tr>
      <th>50</th>
      <td>1.509039</td>
      <td>51.0</td>
      <td>Did you hear that Clinton has announced there ...</td>
    </tr>
    <tr>
      <th>53</th>
      <td>1.463231</td>
      <td>54.0</td>
      <td>The Pope dies and, naturally, goes to heaven. ...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">elbow_dict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">500</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
    <span class="n">elbow_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">k</span><span class="p">)</span>
    <span class="n">kmeans</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">jester_ratings_pivot_df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
    
    <span class="n">elbow_dict</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;kmeans&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kmeans</span>
    <span class="n">elbow_dict</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;inertia&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">inertia_</span>
    <span class="n">elbow_dict</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;user_cluster&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">kmeans</span><span class="o">.</span><span class="n">labels_</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">jester_ratings_pivot_df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5
10
50
100
200
500
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">clustering</span> <span class="ow">in</span> <span class="n">elbow_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">clustering</span><span class="p">[</span><span class="s1">&#39;inertia&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>39282887.116419956
36456133.44415126
31997079.132014535
30295914.351647645
28679506.336334243
26367649.15034368
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">inertia</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">clustering</span><span class="p">[</span><span class="s1">&#39;inertia&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">clustering</span> <span class="ow">in</span> <span class="n">elbow_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()],</span> <span class="n">index</span><span class="o">=</span><span class="n">elbow_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">inertia</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">inertia</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fa6ec815250&gt;
</pre></div>
</div>
<img alt="../_images/Jokes_105_1.svg" src="../_images/Jokes_105_1.svg" /></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">elbow_dict</span><span class="p">[</span><span class="mi">100</span><span class="p">][</span><span class="s1">&#39;user_cluster&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>87    3840
41    2218
55    1817
20    1703
63    1670
      ... 
36      74
56      60
45      59
88      38
77       1
Length: 100, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">elbow_dict</span><span class="p">[</span><span class="mi">500</span><span class="p">][</span><span class="s1">&#39;user_cluster&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>336    2090
15     1384
179     850
362     765
297     747
       ... 
462       1
356       1
435       1
209       1
487       1
Length: 500, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">NearestNeighbors</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nbrs</span> <span class="o">=</span> <span class="n">NearestNeighbors</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">nbrs</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">jester_ratings_pivot_df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>NearestNeighbors()
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">jester_ratings_pivot_df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="mi">1</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>jokeId</th>
      <th>5</th>
      <th>7</th>
      <th>8</th>
      <th>13</th>
      <th>15</th>
      <th>16</th>
      <th>17</th>
      <th>18</th>
      <th>19</th>
      <th>20</th>
      <th>...</th>
      <th>141</th>
      <th>142</th>
      <th>143</th>
      <th>144</th>
      <th>145</th>
      <th>146</th>
      <th>147</th>
      <th>148</th>
      <th>149</th>
      <th>150</th>
    </tr>
    <tr>
      <th>userId</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>0.219</td>
      <td>-9.281</td>
      <td>-9.281</td>
      <td>-6.781</td>
      <td>0.875</td>
      <td>-9.656</td>
      <td>-9.031</td>
      <td>-7.469</td>
      <td>-8.719</td>
      <td>-9.156</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>1 rows × 140 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dist</span><span class="p">,</span> <span class="n">neighbours</span> <span class="o">=</span> <span class="n">nbrs</span><span class="o">.</span><span class="n">kneighbors</span><span class="p">(</span><span class="n">jester_ratings_pivot_df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">neighbours</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0, 44456, 100, 4214, 51129]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">neighbours_ratings</span> <span class="o">=</span> <span class="n">jester_ratings_pivot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">neighbours</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">1</span><span class="p">:]]</span>
<span class="n">neighbours_ratings</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>jokeId</th>
      <th>5</th>
      <th>7</th>
      <th>8</th>
      <th>13</th>
      <th>15</th>
      <th>16</th>
      <th>17</th>
      <th>18</th>
      <th>19</th>
      <th>20</th>
      <th>...</th>
      <th>141</th>
      <th>142</th>
      <th>143</th>
      <th>144</th>
      <th>145</th>
      <th>146</th>
      <th>147</th>
      <th>148</th>
      <th>149</th>
      <th>150</th>
    </tr>
    <tr>
      <th>userId</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>47727</th>
      <td>NaN</td>
      <td>-5.938</td>
      <td>-5.938</td>
      <td>-6.188</td>
      <td>-8.594</td>
      <td>-7.844</td>
      <td>-8.031</td>
      <td>-7.562</td>
      <td>-7.750</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>6.438</td>
      <td>NaN</td>
      <td>5.594</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>114</th>
      <td>8.438</td>
      <td>-5.594</td>
      <td>-3.344</td>
      <td>-3.750</td>
      <td>2.594</td>
      <td>-8.312</td>
      <td>-5.469</td>
      <td>-4.469</td>
      <td>-2.531</td>
      <td>-3.969</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4641</th>
      <td>NaN</td>
      <td>-4.531</td>
      <td>-6.188</td>
      <td>-2.375</td>
      <td>-2.750</td>
      <td>-1.938</td>
      <td>-5.250</td>
      <td>-3.625</td>
      <td>1.156</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>6.031</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>7.125</td>
      <td>6.719</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>55103</th>
      <td>NaN</td>
      <td>-6.875</td>
      <td>-6.875</td>
      <td>-6.875</td>
      <td>-5.750</td>
      <td>-5.719</td>
      <td>-5.719</td>
      <td>-5.719</td>
      <td>-5.719</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.375</td>
      <td>NaN</td>
      <td>5.125</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.625</td>
      <td>4.156</td>
      <td>2.375</td>
    </tr>
  </tbody>
</table>
<p>4 rows × 140 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">approriate_jokes</span> <span class="o">=</span> <span class="n">neighbours_ratings</span><span class="o">.</span><span class="n">mean</span><span class="p">()[</span><span class="n">neighbours_ratings</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">&gt;</span><span class="mi">7</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">approriate_jokes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[5, 27, 29, 50, 69, 105, 121, 122, 123, 125]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">recommended_jokes</span> <span class="o">=</span> <span class="n">jester_ratings_pivot_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="n">approriate_jokes</span><span class="p">]</span>
<span class="n">recommended_jokes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>jokeId
5      0.219
27     8.781
29     8.781
50     9.906
69     8.688
105    2.000
121    8.781
122      NaN
123    8.781
125      NaN
Name: 1, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">recommended_jokes</span><span class="p">[</span><span class="n">recommended_jokes</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[122, 125]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">joke</span> <span class="ow">in</span> <span class="n">jester_jokes_df</span><span class="p">[</span><span class="n">jester_jokes_df</span><span class="o">.</span><span class="n">jokeId</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">recommended_jokes</span><span class="p">[</span><span class="o">~</span><span class="n">recommended_jokes</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">())]</span><span class="o">.</span><span class="n">jokeText</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">joke</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Q.	What&#39;s O. J. Simpson&#39;s Internet address? 
A.	Slash, slash, backslash, slash, slash, escape.

---
Clinton returns from a vacation in Arkansas and walks down  the
steps of Air Force One with two pigs under his arms.  At the bottom
of the steps, he says  to the honor guardsman, &quot;These are genuine
Arkansas Razor-Back Hogs.  I got this one for Chelsea and this one for
Hillary.&quot;  

The guardsman replies, &quot;Nice trade, Sir.&quot;

---
An old Scotsmen is sitting with a younger Scottish gentleman and says the boy. 
&quot;Ah, lad look out that window. You see that stone wall there, I built it with
me own bare hands, placed every stone meself.  But do they call me MacGregor the
wall builder? No! 

He Takes a few sips of his beer then says, &quot;Aye, and look out on that lake and 
eye that beautiful pier. I built it meself, laid every board and hammered each
nail but do they call me MacGregor the pier builder? No! 

He continues...&quot;And lad, you see that road? That too I build with me own bare 
hands. Laid every inch of pavement meself, but do they call MacGregor the road
builder? No!&quot;

Again he returns to his beer for a few sips, then says, 
&quot;Agh, but you screw one sheep...&quot;

---
A guy goes into confession and says to the priest, &quot;Father, I&#39;m 80 years
old, widower, with 11 grandchildren. Last night I met two beautiful flight
attendants. They took me home and I made love to both of them. Twice.&quot;

The priest said: &quot;Well, my son, when was the last time you were in
confession?&quot;
 &quot;Never Father, I&#39;m Jewish.&quot;
 &quot;So then, why are you telling me?&quot;
 &quot;I&#39;m telling everybody.&quot;

---
This guys wife asks, &quot;Honey if I died would you remarry?&quot; and he replies,
&quot;Well, after a considerable period of grieving, we all need
companionship, I guess I would.&quot;

She then asks, &quot;If I died and you remarried, would she live in this
house?&quot; and he replies, &quot;We&#39;ve spent a lot of time and money getting this
house just the way we want it. I&#39;m not going to get rid of my house, I
guess she would.&quot;

&quot;If I died and you remarried, and she lived in this house, would she
sleep in our bed?&quot; and he says, &quot;That bed is brand new, we just paid two
thousand dollars for it, it&#39;s going to last a long time, I guess she
would.&quot;

So she asks, &quot;If I died and you remarried, and she lived in this house,
and slept in our bed, would she use my golf clubs?&quot;

&quot;Oh no, she&#39;s left handed.&quot;

---
A couple of hunters are out in the woods in the deep south when one of them falls to the ground. He doesn&#39;t seem to be breathing, and his eyes are rolled back in his head. The other guy whips out his cell phone and calls 911. He gasps to the operator, &quot;My friend is dead! What can I do?&quot; The operator, in a calm and soothing voice, says, &quot;Alright, take it easy. I can help. First, let&#39;s make sure he&#39;s dead.&quot; There is silence, and then a gun shot is heard. The hunter comes back on the line. &quot;Okay. Now what??&quot;
---
A drunk staggers into a Catholic Church, enters a confessional booth, sits down, but says nothing. The Priest coughs a few times to get his attention but the drunk just sits there. Finally, the Priest pounds three times on the wall. The drunk mumbles, &quot;Ain&#39;t no use knockin, there&#39;s no paper on this side either.&quot;
---
When most people claim to be &quot;killing time&quot;, it&#39;s only an expression. When Chuck Norris kills time, the minutes actually cease to exist.
---
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">joke</span> <span class="ow">in</span> <span class="n">jester_jokes_df</span><span class="p">[</span><span class="n">jester_jokes_df</span><span class="o">.</span><span class="n">jokeId</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">recommended_jokes</span><span class="p">[</span><span class="n">recommended_jokes</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">())]</span><span class="o">.</span><span class="n">jokeText</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">joke</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>An astronomer, a physicist and a mathematician (it is said) were holidaying in Scotland. Glancing from a train window, they observed a black sheep in the middle of a field. &quot;How interesting,&quot; observed the astronomer, &quot;All Scottish sheep are black!&quot; To which the physicist responded, &quot;No, no! Some Scottish sheep are black!&quot; The mathematician gazed heavenward in supplication, and then intoned, &quot;In Scotland there exists at least one field, containing at least one sheep, at least one side of which is black.&quot;
---
An American tourist goes into a restaurant in Spain and orders the specialty of the house. When his dinner arrives, he asks the waiter what it is. &quot;These, senor,&quot; replied the waiter in broken English, &quot;are the testicles of the bull killed in the ring today.&quot; The tourist swallowed hard but tasted the dish and thought it was delicious. So he comes back the next evening and orders the same item. When it is served, he says to the waiter, &quot;These testicles...are much smaller than the ones I had last night.&quot; &quot;Yes, senor,&quot; replied the waiter, &quot;You see...the bull, he does not always lose.
---
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./c7_case_studies"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    
    <div id="prev">
        <a class="left-prev" href="UserSurvey.html" title="previous page">
            <i class="prevnext-label fas fa-angle-left"></i>
            <div class="prevnext-info">
                <p class="prevnext-label">previous</p>
                <p class="prevnext-title"><span class="section-number">38. </span>Case Study: User survey</p>
            </div>
        </a>
    </div>

</div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Lorenz Feyen<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>